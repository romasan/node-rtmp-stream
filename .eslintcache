[{"/Users/r.bauer/Fun/node-rtmp-stream/src/App.tsx":"1","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Bar/Bar.tsx":"2","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Bar/index.ts":"3","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Canvas/Canvas.tsx":"4","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Canvas/index.ts":"5","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Chat/Chat.tsx":"6","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Chat/index.ts":"7","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Countdown/Countdown.tsx":"8","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Countdown/index.ts":"9","/Users/r.bauer/Fun/node-rtmp-stream/src/components/FAQ/FAQ.tsx":"10","/Users/r.bauer/Fun/node-rtmp-stream/src/components/FAQ/index.ts":"11","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Info/Info.tsx":"12","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Info/index.ts":"13","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Modal/Modal.tsx":"14","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Modal/index.ts":"15","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Palette/Palette.tsx":"16","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Palette/index.ts":"17","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/Tools.tsx":"18","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Block/Block.tsx":"19","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Block/index.ts":"20","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/FillSquare/FillSquare.tsx":"21","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/FillSquare/index.ts":"22","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Maps/Maps.tsx":"23","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Maps/index.ts":"24","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/PixelStats/PixelStats.tsx":"25","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/PixelStats/index.ts":"26","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Stats/Stats.tsx":"27","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Stats/index.ts":"28","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Stream/Stream.tsx":"29","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Stream/index.ts":"30","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/index.ts":"31","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/context.ts":"32","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/helpers.ts":"33","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/index.ts":"34","/Users/r.bauer/Fun/node-rtmp-stream/src/components/index.ts":"35","/Users/r.bauer/Fun/node-rtmp-stream/src/containers/Admin/App.tsx":"36","/Users/r.bauer/Fun/node-rtmp-stream/src/containers/Admin/index.tsx":"37","/Users/r.bauer/Fun/node-rtmp-stream/src/declaration.d.ts":"38","/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/color.ts":"39","/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/formatDate.ts":"40","/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/formatNumber.ts":"41","/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/getInRange.ts":"42","/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/index.ts":"43","/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/posIsAbove.ts":"44","/Users/r.bauer/Fun/node-rtmp-stream/src/hooks/useDraggable.ts":"45","/Users/r.bauer/Fun/node-rtmp-stream/src/index.tsx":"46","/Users/r.bauer/Fun/node-rtmp-stream/src/lib/api.ts":"47","/Users/r.bauer/Fun/node-rtmp-stream/src/lib/ee.ts":"48","/Users/r.bauer/Fun/node-rtmp-stream/src/lib/ws.ts":"49"},{"size":7177,"mtime":1699715597246,"results":"50","hashOfConfig":"51"},{"size":1290,"mtime":1699715530012,"results":"52","hashOfConfig":"51"},{"size":23,"mtime":1680551867084,"results":"53","hashOfConfig":"51"},{"size":15151,"mtime":1699715488415,"results":"54","hashOfConfig":"51"},{"size":26,"mtime":1680551867095,"results":"55","hashOfConfig":"51"},{"size":3889,"mtime":1699715381427,"results":"56","hashOfConfig":"51"},{"size":24,"mtime":1694350718630,"results":"57","hashOfConfig":"51"},{"size":1114,"mtime":1699715371595,"results":"58","hashOfConfig":"51"},{"size":29,"mtime":1697981144862,"results":"59","hashOfConfig":"51"},{"size":168,"mtime":1699715366196,"results":"60","hashOfConfig":"51"},{"size":23,"mtime":1680551867101,"results":"61","hashOfConfig":"51"},{"size":1599,"mtime":1699715350927,"results":"62","hashOfConfig":"51"},{"size":24,"mtime":1695550073214,"results":"63","hashOfConfig":"51"},{"size":487,"mtime":1699715313088,"results":"64","hashOfConfig":"51"},{"size":25,"mtime":1680551867110,"results":"65","hashOfConfig":"51"},{"size":1851,"mtime":1699715307595,"results":"66","hashOfConfig":"51"},{"size":27,"mtime":1680551867130,"results":"67","hashOfConfig":"51"},{"size":2311,"mtime":1699715303005,"results":"68","hashOfConfig":"51"},{"size":1127,"mtime":1699715297162,"results":"69","hashOfConfig":"51"},{"size":25,"mtime":1695431539464,"results":"70","hashOfConfig":"51"},{"size":1509,"mtime":1699715281886,"results":"71","hashOfConfig":"51"},{"size":30,"mtime":1696699181048,"results":"72","hashOfConfig":"51"},{"size":2673,"mtime":1699715161390,"results":"73","hashOfConfig":"51"},{"size":24,"mtime":1697874500887,"results":"74","hashOfConfig":"51"},{"size":1931,"mtime":1699715149890,"results":"75","hashOfConfig":"51"},{"size":30,"mtime":1696698057037,"results":"76","hashOfConfig":"51"},{"size":1264,"mtime":1699715145789,"results":"77","hashOfConfig":"51"},{"size":25,"mtime":1696697058073,"results":"78","hashOfConfig":"51"},{"size":1411,"mtime":1699715091095,"results":"79","hashOfConfig":"51"},{"size":26,"mtime":1696696844078,"results":"80","hashOfConfig":"51"},{"size":135,"mtime":1697874729265,"results":"81","hashOfConfig":"51"},{"size":143,"mtime":1695462139450,"results":"82","hashOfConfig":"51"},{"size":1129,"mtime":1697875164300,"results":"83","hashOfConfig":"51"},{"size":25,"mtime":1695427482401,"results":"84","hashOfConfig":"51"},{"size":226,"mtime":1697981761755,"results":"85","hashOfConfig":"51"},{"size":2120,"mtime":1699715022316,"results":"86","hashOfConfig":"51"},{"size":387,"mtime":1699714965963,"results":"87","hashOfConfig":"51"},{"size":32,"mtime":1699714944562,"results":"88","hashOfConfig":"51"},{"size":621,"mtime":1699714934467,"results":"89","hashOfConfig":"51"},{"size":689,"mtime":1699714899504,"results":"90","hashOfConfig":"51"},{"size":241,"mtime":1695979808307,"results":"91","hashOfConfig":"51"},{"size":130,"mtime":1699714911748,"results":"92","hashOfConfig":"51"},{"size":147,"mtime":1698509471612,"results":"93","hashOfConfig":"51"},{"size":218,"mtime":1699715657668,"results":"94","hashOfConfig":"51"},{"size":2217,"mtime":1699715649346,"results":"95","hashOfConfig":"51"},{"size":378,"mtime":1699715631965,"results":"96","hashOfConfig":"51"},{"size":1377,"mtime":1699713496345,"results":"97","hashOfConfig":"51"},{"size":81,"mtime":1680551867137,"results":"98","hashOfConfig":"51"},{"size":1006,"mtime":1696205775671,"results":"99","hashOfConfig":"51"},{"filePath":"100","messages":"101","suppressedMessages":"102","errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"103"},"nju3rz",{"filePath":"104","messages":"105","suppressedMessages":"106","errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"107"},{"filePath":"108","messages":"109","suppressedMessages":"110","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"111","messages":"112","suppressedMessages":"113","errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"114"},{"filePath":"115","messages":"116","suppressedMessages":"117","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"118","messages":"119","suppressedMessages":"120","errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":5,"fixableWarningCount":0,"source":"121"},{"filePath":"122","messages":"123","suppressedMessages":"124","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"125","messages":"126","suppressedMessages":"127","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"128","messages":"129","suppressedMessages":"130","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"131","messages":"132","suppressedMessages":"133","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"134","messages":"135","suppressedMessages":"136","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"137","messages":"138","suppressedMessages":"139","errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"140"},{"filePath":"141","messages":"142","suppressedMessages":"143","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"144","messages":"145","suppressedMessages":"146","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"147","messages":"148","suppressedMessages":"149","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"150","messages":"151","suppressedMessages":"152","errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"153"},{"filePath":"154","messages":"155","suppressedMessages":"156","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"157","messages":"158","suppressedMessages":"159","errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"160"},{"filePath":"161","messages":"162","suppressedMessages":"163","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"164","messages":"165","suppressedMessages":"166","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"167","messages":"168","suppressedMessages":"169","errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"170"},{"filePath":"171","messages":"172","suppressedMessages":"173","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"174","messages":"175","suppressedMessages":"176","errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"177"},{"filePath":"178","messages":"179","suppressedMessages":"180","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"181","messages":"182","suppressedMessages":"183","errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"184"},{"filePath":"185","messages":"186","suppressedMessages":"187","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"188","messages":"189","suppressedMessages":"190","errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"191"},{"filePath":"192","messages":"193","suppressedMessages":"194","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"195","messages":"196","suppressedMessages":"197","errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"198"},{"filePath":"199","messages":"200","suppressedMessages":"201","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"202","messages":"203","suppressedMessages":"204","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"205","messages":"206","suppressedMessages":"207","errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"208"},{"filePath":"209","messages":"210","suppressedMessages":"211","errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"212"},{"filePath":"213","messages":"214","suppressedMessages":"215","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"216","messages":"217","suppressedMessages":"218","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"219","messages":"220","suppressedMessages":"221","errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"222"},{"filePath":"223","messages":"224","suppressedMessages":"225","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"226","messages":"227","suppressedMessages":"228","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"229","messages":"230","suppressedMessages":"231","errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"232"},{"filePath":"233","messages":"234","suppressedMessages":"235","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"236","messages":"237","suppressedMessages":"238","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"239","messages":"240","suppressedMessages":"241","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"242","messages":"243","suppressedMessages":"244","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"245","messages":"246","suppressedMessages":"247","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"248","messages":"249","suppressedMessages":"250","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"251","messages":"252","suppressedMessages":"253","errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":null},{"filePath":"254","messages":"255","suppressedMessages":"256","errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"257"},{"filePath":"258","messages":"259","suppressedMessages":"260","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"261","messages":"262","suppressedMessages":"263","errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"264"},"/Users/r.bauer/Fun/node-rtmp-stream/src/App.tsx",["265","266","267","268"],[],"import React, { useRef, useState, useEffect } from 'react';\n\nimport cn from 'classnames';\n\nimport mobile from 'is-mobile';\n\nimport {\n\tCanvas,\n\tPalette,\n\tModal,\n\tChat,\n\tInfo,\n\tCountdown,\n} from './components/';\n\nimport { addPix } from './lib/api';\nimport ee from './lib/ee';\n\nimport twitch from 'url:../res/twitch.svg';\nimport vkplay from 'url:../res/vkplay.svg';\nimport youtube from 'url:../res/youtube.svg';\nimport discord from 'url:../res/discord.svg';\nimport telegram from 'url:../res/telegram.svg';\nimport chat from 'url:../res/chat.svg';\nimport login from 'url:../res/login.svg';\nimport logout from 'url:../res/logout.svg';\nimport info from 'url:../res/info.svg';\n\nimport * as s from './App.module.scss';\n\nconst disableMouse = {\n\tonMouseDown: (e: MouseEvent) => e.stopPropagation(),\n\tonMouseMove: (e: MouseEvent) => e.stopPropagation(),\n\tonMouseUp: (e: MouseEvent) => e.stopPropagation(),\n};\n\nexport const App: React.FC = () => {\n\tconst [showed, toggle] = useState(false);\n\tconst [wsStore, setWsStore] = useState<any>({});\n\tconst [color, setColor] = useState('');\n\tconst [chatIsShowed, setChatIsShowed] = useState(false);\n\tconst [infoIsShowed, setInfoIsShowed] = useState(false);\n\tconst [isAuthorized, setIsAuthorized] = useState(false);\n\tconst [expiration, setExpiration] = useState(0);\n\tconst [isOnline, setIsOnline] = useState(false);\n\tconst [blinkedLoginAnimation, setBlinkedLoginAnimation] = useState(false);\n\tconst [finish, setFinish] = useState(0);\n\tconst [finished, setFinished] = useState(false);\n\tconst [hasNewMessage, setHasNewMessage] = useState(false);\n\tconst blinkedTimer = useRef(-1);\n\n\tconst toggleChat = () => {\n\t\tsetHasNewMessage(false);\n\t\tsetChatIsShowed((value) => !value);\n\t};\n\n\tconst toggleInfo = () => {\n\t\tsetInfoIsShowed((value) => !value);\n\t};\n\n\tconst isMobile = mobile();\n\n\tuseEffect(() => {\n\t\tif (!color && wsStore?.palette) {\n\t\t\tconst firstColor = 'black' in wsStore?.palette\n\t\t\t\t? 'black'\n\t\t\t\t: (Object.keys(wsStore?.palette) || []).pop();\n\n\t\t\tsetColor(firstColor as string);\n\t\t}\n\t}, [color, wsStore]);\n\n\tuseEffect(() => {\n\t\tif (finish) {\n\t\t\tconst timer = setInterval(() => {\n\t\t\t\tif (finish <= Date.now()) {\n\t\t\t\t\tsetFinished(true);\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\n\t\t\treturn () => {\n\t\t\t\tclearInterval(timer);\n\t\t\t};\n\t\t}\n\n\t}, [finish]);\n\n\tconst handleCanvasClick = (x: number, y: number) => {\n\t\taddPix({ x, y, color });\n\t};\n\n\tconst handleOpenChatClick = () => {\n\t\twindow.open('https://vkplay.live/pixel_battle/only-chat', '', `width=500,height=500,left=${window.innerWidth / 2 - 250},top=${window.innerHeight / 2 - 250}`);\n\t};\n\n\tconst handleTwitchLoginClick = () => {\n\t\tconst { hostname, protocol } = document.location;\n\t\tconst APIhost = `${protocol}//${hostname === 'localhost' ? '' : 'api.'}${hostname.replace('www.', '')}:8080`;\n\t\t// window.open(`${APIhost}/auth/twitch`, '', `width=500,height=500,left=${window.innerWidth / 2 - 250},top=${window.innerHeight / 2 - 250}`);\n\t\tdocument.location.href = `${APIhost}/auth/twitch`;\n\t};\n\n\tconst onWsInit = (payload: any) => {\n\t\tsetWsStore((store = {}) => ({ ...store, ...payload }));\n\t\tsetExpiration(Date.now() + payload?.countdown);\n\t\tsetIsAuthorized(payload?.isAuthorized);\n\t\tif (payload.finish !== 'newer') {\n\t\t\tsetFinish(Date.now() + payload.finish);\n\t\t}\n\t};\n\n\tconst onWsCountdown = (countdown: number) => {\n\t\tsetWsStore((store = {}) => ({ ...store, countdown }));\n\t\tsetExpiration(Date.now() + countdown);\n\t};\n\n\tconst onWsPix = (payload: string) => {\n\t\tif (payload === 'await' && !isAuthorized) {\n\t\t\tsetBlinkedLoginAnimation(true);\n\t\t\tclearTimeout(blinkedTimer.current);\n\t\t\tblinkedTimer.current = setTimeout(() => {\n\t\t\t\tsetBlinkedLoginAnimation(false);\n\t\t\t}, 3000);\n\t\t}\n\t};\n\n\tconst onWsConnect = (payload: boolean) => {\n\t\tsetIsOnline(payload);\n\t};\n\n\tconst handleChatMessage = (message: any) => {\n\t\tif (wsStore?.name && message.text.indexOf(`@${wsStore.name}`) >= 0) {\n\t\t\tsetHasNewMessage(true);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tee.on('ws:init', onWsInit);\n\t\tee.on('ws:countdown', onWsCountdown);\n\t\tee.on('pix', onWsPix);\n\t\tee.on('ws:connect', onWsConnect);\n\t\tee.on('ws:chatMessage', handleChatMessage);\n\n\t\treturn () => {\n\t\t\tee.off('ws:init', onWsInit);\n\t\t\tee.off('ws:countdown', onWsCountdown);\n\t\t\tee.off('pix', onWsPix);\n\t\t\tee.off('ws:connect', onWsConnect);\n\t\t};\n\t}, [isAuthorized]);\n\n\treturn (\n\t\t<div className={isMobile ? 'mobile' : ''}>\n\t\t\t<div className={s.header} {...disableMouse}>\n\t\t\t\t{isAuthorized ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className={s.userName}>\n\t\t\t\t\t\t\t{wsStore?.name}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a href=\"/logout\" className={cn({ [s.disabled]: !isOnline })}>\n\t\t\t\t\t\t\t<img src={logout} className={s.iconButton} />\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</>\n\t\t\t\t) : (\n\t\t\t\t\t<a href=\"/login\" className={cn({ [s.disabled]: !isOnline, [s.blinked]: blinkedLoginAnimation })}>\n\t\t\t\t\t\t<img src={login} className={s.iconButton} />\n\t\t\t\t\t</a>\n\t\t\t\t)}\n\t\t\t\t<span className={cn(s.iconWrapper, { [s.badge]: hasNewMessage && !chatIsShowed })}>\n\t\t\t\t\t<img src={chat} onClick={toggleChat} className={s.iconButton} />\n\t\t\t\t</span>\n\t\t\t\t<img src={info} onClick={toggleInfo} className={cn(s.iconButton, { [s.disabled]: !isOnline })} />\n\t\t\t</div>\n\t\t\t<Canvas\n\t\t\t\tcolor={wsStore?.palette?.[color]}\n\t\t\t\tonClick={handleCanvasClick}\n\t\t\t\texpiration={expiration}\n\t\t\t\tisAuthorized={isAuthorized}\n\t\t\t\tfinished={finished}\n\t\t\t/>\n\t\t\t{wsStore?.palette && !finished && (\n\t\t\t\t<Palette color={color} colors={wsStore?.palette} setColor={setColor} expiration={expiration} />\n\t\t\t)}\n\t\t\t{showed && (\n\t\t\t\t<Modal onClose={() => toggle(false)}>\n\t\t\t\t\t<div className={s.joinModalContent}>\n\t\t\t\t\t\t<div>Чтобы присоединиться к PIXEL BATTLE</div>\n\t\t\t\t\t\t<div>напиши свой ник на VK Play</div>\n\t\t\t\t\t\t<div><input type=\"text\" className={s.input} placeholder=\"nickname\" /></div>\n\t\t\t\t\t\t<div>и отправь в чат стрима <span className={s.command}>!join</span></div>\n\t\t\t\t\t\t<button onClick={handleOpenChatClick} className={s.button}>ОТКРЫТЬ ЧАТ</button>\n\t\t\t\t\t\t<button onClick={handleTwitchLoginClick} className={s.button}>Залогинься через Twitch</button>\n\t\t\t\t\t\t<div>или</div>\n\t\t\t\t\t\t<button onClick={handleTwitchLoginClick} className={s.button}>Залогинься через ВК</button>\n\t\t\t\t\t</div>\n\t\t\t\t</Modal>\n\t\t\t)}\n\t\t\t{Boolean(finish) && (\n\t\t\t\t<Countdown finish={finish} text={wsStore.finishText}/>\n\t\t\t)}\n\t\t\t<div className={s.footer} {...disableMouse}>\n\t\t\t\t<a href=\"https://vkplay.live/place_tv\" target=\"_blank\" rel=\"noreferrer\">\n\t\t\t\t\t<img src={vkplay} />\n\t\t\t\t</a>\n\t\t\t\t<a href=\"https://www.twitch.tv/place_ru\" target=\"_blank\" rel=\"noreferrer\">\n\t\t\t\t\t<img src={twitch} />\n\t\t\t\t</a>\n\t\t\t\t<a href=\"https://www.youtube.com/@Place-ru\" target=\"_blank\" rel=\"noreferrer\">\n\t\t\t\t\t<img src={youtube} />\n\t\t\t\t</a>\n\t\t\t\t<a href=\"https://discord.gg/FfVjurYrus\" target=\"_blank\" rel=\"noreferrer\">\n\t\t\t\t\t<img src={discord} />\n\t\t\t\t</a>\n\t\t\t\t<a href=\"https://t.me/pixel_battle_online\" target=\"_blank\" rel=\"noreferrer\">\n\t\t\t\t\t<img src={telegram} />\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t\t{chatIsShowed && (\n\t\t\t\t<Chat\n\t\t\t\t\tisAuthorized={isAuthorized}\n\t\t\t\t\tnickname={wsStore?.name}\n\t\t\t\t\tonClose={toggleChat}\n\t\t\t\t\t{...disableMouse}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{infoIsShowed && (\n\t\t\t\t<Info {...disableMouse} onClose={toggleInfo} />\n\t\t\t)}\n\t\t</div>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Bar/Bar.tsx",["269"],[],"import React, { FC } from 'react';\n\nimport { useDraggable } from '../../hooks/useDraggable';\n\nimport pen from 'url:../../../res/pen.svg';\nimport plus from 'url:../../../res/plus.svg';\nimport minus from 'url:../../../res/minus.svg';\nimport expand from 'url:../../../res/expand.svg';\n// import clock from 'url:../../../res/clock.svg';\n\nimport * as s from './Bar.module.scss';\n\ninterface Props {\n\tonDraw?(): void;\n\tonPlus?(): void;\n\tonMinus?(): void;\n\tonPlace?(): void;\n}\n\nexport const Bar: FC<Props> = ({\n\tonDraw,\n\tonPlus,\n\tonMinus,\n\tonPlace,\n}) => {\n\tconst { anchorRef, draggableRef } = useDraggable({ x: 10, y: 10});\n\n\treturn (\n\t\t<div className={s.root} ref={draggableRef}>\n\t\t\t<div className={s.draggable} ref={anchorRef}></div>\n\t\t\t{onDraw && (\n\t\t\t\t<button className={s.button} onClick={onDraw}>\n\t\t\t\t\t<img src={pen} />\n\t\t\t\t</button>\n\t\t\t)}\n\t\t\t{onPlus && (\n\t\t\t\t\t<button className={s.button} onClick={onPlus}>\n\t\t\t\t\t<img src={plus} />\n\t\t\t\t</button>\n\t\t\t)}\n\t\t\t{onMinus && (\n\t\t\t\t<button className={s.button} onClick={onMinus}>\n\t\t\t\t\t<img src={minus} />\n\t\t\t\t</button>\n\t\t\t)}\n\t\t\t{onPlace && (\n\t\t\t\t<button className={s.button} onClick={onPlace}>\n\t\t\t\t\t<img src={expand} />\n\t\t\t\t</button>\n\t\t\t)}\n\t\t\t{/* TODO */}\n\t\t\t{/* <button className={s.button}>\n\t\t\t\t<img src={clock} />\n\t\t\t</button> */}\n\t\t</div>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Bar/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Canvas/Canvas.tsx",["270","271","272","273","274","275"],[],"import React, { FC, useRef, useState, useMemo, useCallback, useEffect, PropsWithChildren } from 'react';\n\nimport mobile from 'is-mobile';\n\nimport cn from 'classnames';\n\nimport ee from '../../lib/ee';\nimport { WSHost } from '../../lib/ws';\nimport {\n\tposIsAbove,\n\tgetInRange,\n\thexToRgb,\n\trgbToHex,\n\tinvertRgb,\n\tgetPixelColor,\n\tformatDate,\n} from '../../helpers';\nimport { getPixel } from '../../lib/api';\n\nimport { Bar } from '../Bar';\n\nimport image404 from 'url:../../../res/404.png';\n\nimport * as s from './Canvas.module.scss';\n\nexport enum EMode {\n\tCLICK = 'CLICK',\n\tSELECT = 'SELECT',\n}\n\ninterface Props {\n\tcolor: string;\n\tmode?: EMode;\n\tclassName?: string;\n\texpiration?: number;\n\tisAuthorized?: boolean;\n\tfinished?: boolean;\n\tonClick(x: number, y: number): void;\n\tonSelect?: (from: { x: number, y: number }, to: { x: number, y: number }) => void;\n\tonInit?: (value: any) => void;\n}\n\nconst showPixelScale = 6;\nconst scaleDegree = 1.1;\nconst minScale = 1;\nconst maxScale = 50;\n\nconst defautSelected = {\n\tfrom: { x: 0, y: 0 },\n\tto: { x: 0, y: 0 },\n};\n\nexport const Canvas: FC<PropsWithChildren<Props>> = ({\n\tcolor,\n\tmode = EMode.CLICK,\n\tclassName,\n\texpiration = 0,\n\tisAuthorized = false,\n\tfinished,\n\tchildren,\n\tonClick,\n\tonSelect,\n\tonInit,\n}) => {\n\tconst isMobile = mobile();\n\tconst firstRender = useRef(true);\n\tconst rootRef = useRef<null | HTMLDivElement>(null);\n\tconst canvasRef = useRef<null | HTMLCanvasElement>(null);\n\tconst pixelRef = useRef<null | HTMLDivElement>(null);\n\tconst cur = useRef<[number, number, boolean]>([-1, -1, false]);\n\tconst [coord, setCoord] = useState<[number, number]>([-1, -1]);\n\tconst [scale, setScale] = useState(2);\n\tconst [pos, setPos] = useState<{ x: number; y: number}>({ x: 0, y: 0 });\n\tconst [error, setError] = useState('');\n\tconst initialDistance = useRef<number | null>(null);\n\tconst [countdown, setCoundown] = useState(0);\n\tconst [animatedPixel, setAnimatedPixel] = useState(false);\n\tconst selected = useRef(defautSelected);\n\tconst timer = useRef(0);\n\tconst [pixelData, setPixelData] = useState({});\n\n\tconst pixelTitle = useMemo(() => {\n\t\tconst [x, y] = coord;\n\n\t\tlet time = '';\n\t\tif (finished) {\n\t\t\ttime = formatDate(Number(pixelData.time));\n\t\t} else {\n\t\t\tconst sec = Math.floor(pixelData.time / 1000);\n\t\t\tconst min = Math.floor(sec / 60);\n\t\t\tconst hour = Math.floor(min / 60);\n\t\t\tconst day = Math.floor(hour / 24);\n\t\t\t\n\t\t\ttime = `${day ? `${day} д. ` : ''}${hour ? `${String(hour % 24).padStart(2, '0')}:` : ''}${String(min % 60).padStart(2, '0')}:${String(sec % 60).padStart(2, '0')}`;\n\t\t}\n\n\t\tif (pixelData.x === x && pixelData.y === y) {\n\t\t\tif (pixelData.time >= 0) {\n\t\t\t\treturn finished\n\t\t\t\t\t? `${pixelData.name}, ${time} `\n\t\t\t\t\t: `${pixelData.name}, ${time} назад`;\n\t\t\t}\n\n\t\t\treturn finished\n\t\t\t\t? 'Про этот пиксель все забыли'\n\t\t\t\t: 'Пустой пиксель, закрась его';\n\t\t}\n\n\t\treturn null;\n\t}, [coord, pixelData, finished]);\n\n\tconst imageLoadHandler = useCallback((image: HTMLImageElement) => {\n\t\tif (canvasRef.current) {\n\t\t\tcanvasRef.current.width = image.width;\n\t\t\tcanvasRef.current.height = image.height;\n\n\t\t\tif (rootRef.current) {\n\t\t\t\tconst { width, height } = rootRef.current.getBoundingClientRect();\n\n\t\t\t\tsetPos({\n\t\t\t\t\tx: width / 2 - image.width / 2,\n\t\t\t\t\ty: height / 2 - image.height / 2,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst ctx = canvasRef.current?.getContext('2d');\n\t\tctx?.drawImage(image, 0, 0);\n\n\t\tonInit?.(image);\n\n\t\tee.on('ws:drawPix', ({ x, y, color }) => {\n\t\t\tif (ctx) {\n\t\t\t\tctx.fillStyle = color;\n\t\t\t\tctx.fillRect(x, y, 1, 1);\n\t\t\t}\n\t\t});\n\t}, [canvasRef.current]);\n\n\tconst handleClickDraw = useCallback(() => {\n\t\tsetScale((scale) => Math.max(scale, showPixelScale));\n\t}, []);\n\n\tconst handleClickPlus = useCallback(() => {\n\t\tsetScale((scale) => getInRange(scale * 2, [minScale, maxScale]));\n\t}, []);\n\n\tconst handleClickMinus = useCallback(() => {\n\t\tsetScale((scale) => getInRange(scale / 2, [minScale, maxScale]));\n\t}, []);\n\n\tconst handleClickPlace = useCallback(() => {\n\t\tif (rootRef.current && canvasRef.current) {\n\t\t\tconst { width, height } = rootRef.current.getBoundingClientRect();\n\t\t\tconst canvas = canvasRef.current.getBoundingClientRect();\n\t\t\tsetPos({\n\t\t\t\tx: width / 2 - canvas.width / scale / 2,\n\t\t\t\ty: height / 2 - canvas.height / scale / 2,\n\t\t\t});\n\t\t\tsetScale(2);\n\t\t}\n\t}, [rootRef.current, canvasRef.current, scale]);\n\n\tconst mouseDownCallback = ({ clientX, clientY, target, touches }: any) => {\n\t\tif (touches && touches.length === 1) {\n\t\t\tclientX = touches[0].clientX;\n\t\t\tclientY = touches[0].clientY;\n\t\t}\n\n\t\tif (touches && touches.length === 2) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\trootRef.current?.contains(target as Node) &&\n\t\t\tcanvasRef.current &&\n\t\t\tposIsAbove([clientX, clientY], canvasRef.current)\n\t\t) {\n\t\t\tcur.current = [clientX, clientY, false];\n\n\t\t\tif (mode === EMode.SELECT) {\n\t\t\t\tconst { top, left } = canvasRef.current.getBoundingClientRect();\n\t\t\t\tconst x = Math.floor((clientX - left) / scale);\n\t\t\t\tconst y = Math.floor((clientY - top) / scale);\n\n\t\t\t\tselected.current = {\n\t\t\t\t\tfrom: { x, y },\n\t\t\t\t\tto: { x, y },\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t};\n\n\tconst mouseMoveCallback = ({ clientX, clientY, touches }: any) => {\n\t\tif (touches) {\n\t\t\tclientX = touches[0].clientX;\n\t\t\tclientY = touches[0].clientY;\n\t\t}\n\n\t\tif (touches && touches.length === 2) {\n\t\t\tconst touch1 = touches[0];\n\t\t\tconst touch2 = touches[1];\n\t\t\tconst dx = touch1.clientX - touch2.clientX;\n\t\t\tconst dy = touch1.clientY - touch2.clientY;\n\t\t\tconst currentDistance = Math.sqrt(dx * dx + dy * dy);\n\n\t\t\tif (!initialDistance.current) {\n\t\t\t\tinitialDistance.current = currentDistance;\n\t\t\t} else {\n\t\t\t\tconst delta = currentDistance - initialDistance.current;\n\t\t\t\tinitialDistance.current = currentDistance;\n\n\t\t\t\tsetScale((scale) => getInRange(scale + delta, [minScale, maxScale]));\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!cur.current.some((e) => e === -1) && mode === EMode.CLICK) {\n\t\t\tconst moveX = (clientX - cur.current[0]) / scale;\n\t\t\tconst moveY = (clientY - cur.current[1]) / scale;\n\n\t\t\tconst [,, moved] = cur.current;\n\n\t\t\tconst { width = 0, height = 0 } = rootRef.current?.getBoundingClientRect() || {};\n\t\t\tconst { width: canvasW = 0, height: canvasH = 0 } = canvasRef.current?.getBoundingClientRect() || {};\n\t\t\tconst center = [\n\t\t\t\twidth / 2,\n\t\t\t\theight / 2,\n\t\t\t];\n\n\t\t\tconst leftFrontier = center[0] - canvasW / scale;\n\t\t\tconst rightFrontier = center[0];\n\t\t\tconst topFrontier = center[1] - canvasH / scale;\n\t\t\tconst bottomFrontier = center[1];\n\n\t\t\tsetPos((pos) => {\n\t\t\t\treturn {\n\t\t\t\t\tx: getInRange(pos.x + moveX, [leftFrontier, rightFrontier]),\n\t\t\t\t\ty: getInRange(pos.y + moveY, [topFrontier, bottomFrontier]),\n\t\t\t\t};\n\t\t\t});\n\t\t\tcur.current = [clientX, clientY, moved || Boolean(Math.abs(moveX) + Math.abs(moveX))];\n\t\t}\n\n\t\tif (canvasRef.current && posIsAbove([clientX, clientY], canvasRef.current)) {\n\t\t\tconst { top, left } = canvasRef.current.getBoundingClientRect();\n\t\t\tconst x = Math.floor((clientX - left) / scale);\n\t\t\tconst y = Math.floor((clientY - top) / scale);\n\n\t\t\tif (mode === EMode.SELECT && !cur.current.some((e) => e === -1)) {\n\t\t\t\tselected.current = {\n\t\t\t\t\tfrom: selected.current.from,\n\t\t\t\t\tto: { x, y },\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tsetCoord([x, y]);\n\t\t} else {\n\t\t\tsetCoord([-1, -1]);\n\t\t}\n\t};\n\n\tconst mouseUpCallback = ({ clientX, clientY, target, touches }: any) => {\n\t\tif (touches) {\n\t\t\tclientX = cur.current[0];\n\t\t\tclientY = cur.current[1];\n\t\t}\n\n\t\tif (touches && touches.length === 2) {\n\t\t\tinitialDistance.current = null;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst [,, moved] = cur.current;\n\n\t\tif (\n\t\t\t!moved &&\n\t\t\t!cur.current.some((e) => e === -1) &&\n\t\t\tdocument.elementsFromPoint(clientX, clientY).includes(canvasRef.current as HTMLCanvasElement) &&\n\t\t\t(scale >= showPixelScale || mode === EMode.SELECT) &&\n\t\t\tcanvasRef.current &&\n\t\t\tposIsAbove([clientX, clientY], canvasRef.current)\n\t\t) {\n\t\t\tconst { top, left } = canvasRef.current.getBoundingClientRect();\n\t\t\tconst x = Math.floor((clientX - left) / scale);\n\t\t\tconst y = Math.floor((clientY - top) / scale);\n\n\t\t\tif (mode === EMode.SELECT) {\n\t\t\t\tonSelect?.(selected.current.from, { x, y });\n\t\t\t\tselected.current = defautSelected;\n\t\t\t} else {\n\t\t\t\tonClick(x, y);\n\t\t\t\tsetPixelData({});\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\t!moved &&\n\t\t\tscale < showPixelScale &&\n\t\t\tcanvasRef.current &&\n\t\t\tposIsAbove([clientX, clientY], canvasRef.current) &&\n\t\t\tmode === EMode.CLICK\n\t\t) {\n\t\t\tsetScale(showPixelScale);\n\t\t}\n\n\t\tcur.current = [-1, -1, false];\n\t};\n\n\tconst dragCallback = (event: DragEvent) => {\n\t\tevent.preventDefault();\n\t};\n\n\tconst handleRootWheel = ({ deltaY, clientX, clientY }: any) => {\n\t\tif (error) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (posIsAbove([clientX, clientY], canvasRef.current as HTMLCanvasElement)) {\n\t\t\tconst { left, top, width: canvasW = 0, height: canvasH = 0 } = (canvasRef.current as HTMLCanvasElement).getBoundingClientRect();\n\t\t\tconst { offsetWidth, offsetHeight } = document.body;\n\t\t\tconst { width = 0, height = 0 } = rootRef.current?.getBoundingClientRect() || {};\n\n\t\t\tconst x = (clientX - left) / scale;\n\t\t\tconst y = (clientY - top) / scale;\n\n\t\t\tconst relativeCenterX = (offsetWidth / 2 - left) / scale;\n\t\t\tconst relativeCenterY = (offsetHeight / 2 - top) / scale;\n\n\t\t\tconst cursorShiftX = x - relativeCenterX;\n\t\t\tconst cursorShiftY = y - relativeCenterY;\n\n\t\t\tconst shiftX = relativeCenterX - x + cursorShiftX / scaleDegree;\n\t\t\tconst shiftY = relativeCenterY - y + cursorShiftY / scaleDegree;\n\n\t\t\tconst center = [\n\t\t\t\twidth / 2,\n\t\t\t\theight / 2,\n\t\t\t];\n\n\t\t\tconst leftFrontier = center[0] - canvasW / scale;\n\t\t\tconst rightFrontier = center[0];\n\t\t\tconst topFrontier = center[1] - canvasH / scale;\n\t\t\tconst bottomFrontier = center[1];\n\n\t\t\tif (\n\t\t\t\t(deltaY > 0 && scale <= minScale) ||\n\t\t\t\t(deltaY < 0 && scale >= maxScale)\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetScale((scale) => getInRange(deltaY < 0 ? scale * scaleDegree : scale / scaleDegree, [minScale, maxScale]));\n\t\t\tsetPos((pos) => (\n\t\t\t\tdeltaY < 0 ? {\n\t\t\t\t\tx: getInRange(pos.x + shiftX, [leftFrontier, rightFrontier]),\n\t\t\t\t\ty: getInRange(pos.y + shiftY, [topFrontier, bottomFrontier]),\n\t\t\t\t} : {\n\t\t\t\t\tx: getInRange(pos.x - shiftX, [leftFrontier, rightFrontier]),\n\t\t\t\t\ty: getInRange(pos.y - shiftY, [topFrontier, bottomFrontier]),\n\t\t\t\t}\n\t\t\t));\n\t\t} else {\n\t\t\tsetScale((scale) => getInRange(deltaY < 0 ? scale * scaleDegree : scale / scaleDegree, [minScale, maxScale]));\n\t\t}\n\t};\n\n\tconst getPixelStyle = () => {\n\t\tconst { left = 0, top = 0 } = canvasRef.current?.getBoundingClientRect() || {};\n\t\tconst [x, y] = coord;\n\n\t\tconst _color = finished ? getPixelColor(canvasRef.current, x, y) : color;\n\n\t\treturn {\n\t\t\tdisplay: coord.some((e) => e < 0) || scale < showPixelScale ? 'none' : 'block',\n\t\t\tleft: `${left + x * scale}px`,\n\t\t\ttop: `${top + y * scale}px`,\n\t\t\twidth: `${scale}px`,\n\t\t\theight: `${scale}px`,\n\t\t\t'--bg-color': _color,\n\t\t\t'--border-color': _color && rgbToHex(invertRgb(hexToRgb(_color))),\n\t\t};\n\t};\n\n\tconst getSelectedStyle = () => {\n\t\tconst { from, to } = selected.current;\n\t\tconst x = Math.min(from.x, to.x);\n\t\tconst y = Math.min(from.y, to.y);\n\t\tconst width = Math.max(from.x, to.x) - x;\n\t\tconst height = Math.max(from.y, to.y) - y;\n\n\t\tif (!width && !height) {\n\t\t\treturn {};\n\t\t}\n\n\t\treturn {\n\t\t\ttop: `${y}px`,\n\t\t\tleft: `${x}px`,\n\t\t\twidth: `${width}px`,\n\t\t\theight: `${height}px`,\n\t\t};\n\t};\n\n\tconst renderCountdown = () => {\n\t\tconst sec = Math.ceil(countdown / 1000);\n\t\tconst min = Math.floor(sec / 60);\n\n\t\treturn `${String(min).padStart(2, '0')}:${String(sec % 60).padStart(2, '0')}`;\n\t};\n\n\tconst onPix = (payload: string) => {\n\t\tif (payload === 'await' && !isAuthorized) {\n\t\t\tsetAnimatedPixel(true);\n\t\t\tsetTimeout(() => {\n\t\t\t\tsetAnimatedPixel(false);\n\t\t\t}, 500);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tif (rootRef.current && canvasRef.current && firstRender.current) {\n\t\t\tfirstRender.current = false;\n\n\t\t\tconst image = new Image();\n\t\t\tconst { protocol, hash } = document.location;\n\n\t\t\tconst sourceProtocol = hash === '#secured' ? 'https:' : protocol;\n\n\t\t\timage.src = `${sourceProtocol}//${WSHost}/canvas.png`;\n\t\t\timage.setAttribute('crossOrigin', '');\n\t\t\timage.onload = () => imageLoadHandler(image);\n\t\t\timage.onerror = (err) => {\n\t\t\t\tsetError(err.toString());\n\t\t\t\tsetScale(1);\n\t\t\t};\n\t\t}\n\n\t\tif (isMobile) {\n\t\t\tdocument.addEventListener('touchstart', mouseDownCallback);\n\t\t\tdocument.addEventListener('touchmove', mouseMoveCallback);\n\t\t\tdocument.addEventListener('touchend', mouseUpCallback);\n\t\t} else {\n\t\t\tdocument.addEventListener('mousedown', mouseDownCallback);\n\t\t\tdocument.addEventListener('mousemove', mouseMoveCallback);\n\t\t\tdocument.addEventListener('mouseup', mouseUpCallback);\n\t\t\tdocument.addEventListener('drag', dragCallback);\n\t\t}\n\n\t\treturn () => {\n\t\t\tif (isMobile) {\n\t\t\t\tdocument.removeEventListener('touchstart', mouseDownCallback);\n\t\t\t\tdocument.removeEventListener('touchmove', mouseMoveCallback);\n\t\t\t\tdocument.removeEventListener('touchend', mouseUpCallback);\n\t\t\t} else {\n\t\t\t\tdocument.removeEventListener('mousedown', mouseDownCallback);\n\t\t\t\tdocument.removeEventListener('mousemove', mouseMoveCallback);\n\t\t\t\tdocument.removeEventListener('mouseup', mouseUpCallback);\n\t\t\t\tdocument.removeEventListener('drag', dragCallback);\n\t\t\t}\n\t\t};\n\t}, [rootRef.current, canvasRef.current, pixelRef.current, scale, color, mode]);\n\n\tuseEffect(() => {\n\t\tconst timer = setInterval(() => {\n\t\t\tif (expiration && Date.now() < expiration) {\n\t\t\t\tsetCoundown(expiration - Date.now());\n\t\t\t} else {\n\t\t\t\tsetCoundown(0);\n\t\t\t\tclearInterval(timer);\n\t\t\t}\n\t\t}, 300);\n\n\t\treturn () => {\n\t\t\tclearInterval(timer);\n\t\t};\n\t}, [expiration]);\n\n\tuseEffect(() => {\n\t\tee.on('pix', onPix);\n\n\t\treturn () => {\n\t\t\tee.off('pix', onPix);\n\t\t};\n\t}, [isAuthorized]);\n\n\tuseEffect(() => {\n\t\tclearTimeout(timer.current);\n\n\t\tif (scale >= showPixelScale && !coord.some((e) => e < 0)) {\n\t\t\ttimer.current = setTimeout(() => {\n\t\t\t\tgetPixel(...coord).then(setPixelData);\n\t\t\t}, 1000);\n\t\t}\n\t}, [coord, scale]);\n\n\treturn (\n\t\t<>\n\t\t\t<div\n\t\t\t\tref={rootRef}\n\t\t\t\tclassName={cn(s.root, className)}\n\t\t\t\tonWheel={handleRootWheel}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={s.workbench}\n\t\t\t\t\tstyle={{ transform: `scale(${scale})` }}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={s.draggable}\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tleft: `${Math.floor(pos.x)}px`,\n\t\t\t\t\t\t\ttop: `${Math.floor(pos.y)}px`,\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<canvas\n\t\t\t\t\t\t\tref={canvasRef}\n\t\t\t\t\t\t\tclassName={cn(s.canvas, {\n\t\t\t\t\t\t\t\t[s.inactive]: scale < showPixelScale,\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{children}\n\t\t\t\t\t\t{mode === EMode.SELECT && (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={s.select}\n\t\t\t\t\t\t\t\tstyle={getSelectedStyle()}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t{error && <img className={s.image404} src={image404} />}\n\t\t\t\t</div>\n\t\t\t\t{!isMobile && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className={s.coordinates}>\n\t\t\t\t\t\t\t{countdown > 0 && (\n\t\t\t\t\t\t\t\t<>{renderCountdown()}&nbsp;</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{coord[0] >= 0 && `[${coord.join(', ')}]`} X{Number(scale.toFixed(1))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{scale >= showPixelScale && (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={cn(s.pixel, { [s.animated]: animatedPixel, [s.withTitle]: pixelTitle })}\n\t\t\t\t\t\t\t\tstyle={scale ? getPixelStyle() : {}}\n\t\t\t\t\t\t\t\tdata-title={pixelTitle}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div className={s.pixelInside}></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t{!isMobile && (\n\t\t\t\t<Bar\n\t\t\t\t\tonDraw={finished ? undefined : handleClickDraw}\n\t\t\t\t\tonPlus={handleClickPlus}\n\t\t\t\t\tonMinus={handleClickMinus}\n\t\t\t\t\tonPlace={handleClickPlace}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Canvas/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Chat/Chat.tsx",["276","277","278","279","280","281","282","283","284","285","286","287"],[],"import React, { FC, useRef, useState, useMemo, useCallback, useEffect } from 'react';\n\nimport cn from 'classnames';\n\nimport { useDraggable } from '../../hooks/useDraggable';\n\nimport { getChatMessages, sendChatMessage } from '../../lib/api';\nimport ee from '../../lib/ee';\n\nimport * as s from './Chat.module.scss';\n\ninterface Props {\n\tisAuthorized: boolean;\n\tnickname?: string;\n\tonClose: Function;\n}\n\ninterface MessageProps {\n\tmessage: {\n\t\tname: string;\n\t\ttext: string;\n\t};\n\tisAuthorized: boolean;\n\tnickname?: string;\n\thandleMention(name: string): void;\n};\n\ninterface IMessage {\n\tid: string;\n\ttime: number;\n\ttext: string;\n\tname: string;\n\tavatar: string;\n}\n\nconst renderText = (raw: string, nickname?: string): string => {\n\treturn raw\n\t\t.replace(nickname ? new RegExp(`@(${nickname})`, \"ig\") : '\\n', '<b>$1</b>')\n\t\t.replace(/(https\\:\\/\\/www\\.youtube\\.com\\/watch\\?v\\=[A-Za-z0-9_]+)/ig, '<a href=\"$1\" target=\"_blank\">$1</a>')\n\t\t.replace(/(https\\:\\/\\/youtu\\.be\\/[A-Za-z0-9_\\-]+)/ig, '<a href=\"$1\" target=\"_blank\">$1</a>')\n};\n\nexport const Message: FC<MessageProps> = ({\n\tmessage,\n\tnickname,\n\tisAuthorized,\n\thandleMention,\n}) => {\n\tconst html = useMemo(() => renderText(message.text, nickname), []);\n\n\treturn (\n\t\t<div>\n\t\t\t<div\n\t\t\t\tclassName={cn({ [s.clickable]: isAuthorized && message.name !== nickname })}\n\t\t\t\tonClick={() => handleMention(message.name)}\n\t\t\t>\n\t\t\t\t{message.name || '[EMPTY NICKNAME]'}:\n\t\t\t</div>\n\t\t\t<div className={s.text} dangerouslySetInnerHTML={{ __html: html }} />\n\t\t</div>\n\t);\n};\n\nexport const Chat: FC<Props> = ({\n\tisAuthorized,\n\tnickname,\n\tonClose,\n\t...props,\n}) => {\n\tconst [list, setList] = useState<IMessage[]>([]);\n\tconst [input, setInput] = useState('');\n\tconst { anchorRef, draggableRef } = useDraggable({ x: document.body.offsetWidth - 330, y: 60});\n\tconst inputRef = useRef<HTMLInputElement>(null);\n\tconst contentRef = useRef<HTMLDivElement>(null);\n\t\n\tconst goToBottom = () => {\n\t\tcontentRef.current?.scrollTo(0, contentRef.current.scrollHeight);\n\t};\n\n\tconst handleChatMessage = (message: IMessage) => {\n\t\tsetList((value) => [...value, message]);\n\t\tsetTimeout(() => {\n\t\t\tgoToBottom();\n\t\t}, 0);\n\t};\n\n\tuseEffect(() => {\n\t\tgetChatMessages().then((messages) => {\n\t\t\tsetList(messages);\n\t\t\tsetTimeout(() => {\n\t\t\t\tgoToBottom();\n\t\t\t}, 0);\n\t\t\tee.on('ws:chatMessage', handleChatMessage);\n\t\t}).catch(() => {});\n\n\t\treturn () => {\n\t\t\tee.off('ws:chatMessage', handleChatMessage);\n\t\t}\n\t}, []);\n\n\tconst onChange = (event: any) => {\n\t\tsetInput(event?.target?.value || '');\n\t};\n\n\tconst sendMessage = () => {\n\t\tif (input) {\n\t\t\tsendChatMessage(input);\n\t\t\tsetInput('');\n\t\t}\n\t};\n\n\tconst onKeyUp = (event: any) => {\n\t\tif (event?.code === 'Enter') {\n\t\t\tsendMessage();\n\t\t}\n\t};\n\n\tconst handleMention = useCallback((name: string) => {\n\t\tif (isAuthorized && name && name !== nickname) {\n\t\t\tsetInput((value) => `${value}${value ? ' ' : ''}@${name} `);\n\t\t\tinputRef.current?.focus();\n\t\t}\n\t}, [isAuthorized, nickname]);\n\n\treturn (\n\t\t<div className={s.root} ref={draggableRef}>\n\t\t\t<div className={s.draggable} ref={anchorRef}>\n\t\t\t\t<button className={s.close} onClick={onClose}>&times;</button>\n\t\t\t</div>\n\t\t\t<div className={s.content} ref={contentRef} {...props}>\n\t\t\t\t{list.map((message) => (\n\t\t\t\t\t<Message\n\t\t\t\t\t\tkey={message.id}\n\t\t\t\t\t\tmessage={message}\n\t\t\t\t\t\tisAuthorized={isAuthorized}\n\t\t\t\t\t\tnickname={nickname}\n\t\t\t\t\t\thandleMention={handleMention}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t\t{list.length === 0 && (\n\t\t\t\t\t<div>пока никто не писал</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t<div className={s.publisher} {...props}>\n\t\t\t\t<input\n\t\t\t\t\tref={inputRef}\n\t\t\t\t\tclassName={s.input}\n\t\t\t\t\tvalue={input}\n\t\t\t\t\tonChange={onChange}\n\t\t\t\t\tonKeyUp={onKeyUp}\n\t\t\t\t\tdisabled={!isAuthorized}\n\t\t\t\t\tplaceholder={isAuthorized ? 'Enter message' : 'Login for enter message'}\n\t\t\t\t\ttitle={'Press Enter for send message'}\n\t\t\t\t/>\n\t\t\t\t<button className={s.button} onClick={sendMessage} disabled={!isAuthorized} />\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Chat/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Countdown/Countdown.tsx",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Countdown/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/FAQ/FAQ.tsx",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/FAQ/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Info/Info.tsx",["288","289"],[],"import React, { FC, useState, useEffect } from 'react';\n\nimport { useDraggable } from '../../hooks/useDraggable';\n\nimport { getStats } from '../../lib/api';\n\nimport { formatNumber } from '../../helpers';\n\nimport * as s from './Info.module.scss';\n\ninterface Props {\n\tonClose: Function;\n}\n\ninterface IMessage {\n\tid: string;\n\ttime: number;\n\ttext: string;\n\tname: string;\n\tavatar: string;\n}\n\nexport const Info: FC<Props> = ({\n\tonClose,\n\t...props,\n}) => {\n\tconst [stats, setStats] = useState({\n\t\tloading: true,\n\t});\n\tconst { anchorRef, draggableRef } = useDraggable({ x: document.body.offsetWidth - 280, y: 60});\n\n\tuseEffect(() => {\n\t\tgetStats().then(setStats).catch(() => {});\n\t}, []);\n\n\treturn (\n\t\t<div className={s.root} ref={draggableRef}>\n\t\t\t<div className={s.draggable} ref={anchorRef}>\n\t\t\t\t<button className={s.close} onClick={onClose}>&times;</button>\n\t\t\t</div>\n\t\t\t<div className={s.content} {...props}>\n\t\t\t\t{stats?.loading ? (\n\t\t\t\t\t<div>Загрузка...</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{/* <div>Online: 0</div> */}\n\t\t\t\t\t\t<div>Всего пикселей: {formatNumber(stats?.total)}</div>\n\t\t\t\t\t\t<div>&nbsp;</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div>ТОП 10 участников:</div>\n\t\t\t\t\t\t\t<div>&nbsp;</div>\n\t\t\t\t\t\t\t{(stats?.leaderboard || []).map((item, index) => (\n\t\t\t\t\t\t\t\t<div key={String(index)} className={s.leaderBoardItem}>\n\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t{index < 9 && <>&nbsp;</>}\n\t\t\t\t\t\t\t\t\t\t{index + 1}.\n\t\t\t\t\t\t\t\t\t\t{item.name}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t{formatNumber(item.count)}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Info/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Modal/Modal.tsx",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Modal/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Palette/Palette.tsx",["290"],[],"import React, { FC, useEffect, useState } from 'react';\n\nimport mobile from 'is-mobile';\n\nimport { useDraggable } from '../../hooks/useDraggable';\n\nimport * as s from './Palette.module.scss';\n\ninterface Props {\n\tcolor: string;\n\tcolors: any;\n\texpiration?: number;\n\tsetColor(value: string): void;\n}\n\nexport const Palette: FC<Props> = ({ color, colors, expiration = 0, setColor }) => {\n\tconst isMobile = mobile();\n\tconst [shouldShowProgress, setShowedProgress] = useState(false);\n\tconst [isProgressInited, setIsProgressInited] = useState(false);\n\n\tconst { anchorRef, draggableRef } = useDraggable({ x: 10, y: window.innerHeight - 100, ready: !isMobile });\n\n\tuseEffect(() => {\n\t\tsetShowedProgress(false);\n\t\tsetIsProgressInited(false);\n\n\t\tsetTimeout(() => {\n\t\t\tsetShowedProgress(true);\n\t\t}, 0);\n\t}, [expiration]);\n\n\tuseEffect(() => {\n\t\tif (shouldShowProgress) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tsetIsProgressInited(true);\n\t\t\t}, 100);\n\t\t}\n\t}, [shouldShowProgress]);\n\n\treturn (\n\t\t<div className={s.root} ref={draggableRef}>\n\t\t\t{!isMobile && <div className={s.draggable} ref={anchorRef}></div>}\n\t\t\t<div className={s.paletteContent}>\n\n\t\t\t\t<div className={s.paletteControls}>\n\t\t\t\t\t<div className={s.currentColorWrapper}>\n\t\t\t\t\t\t<div className={s.currentColor} style={{ background: colors[color]}}></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={s.colors}>\n\t\t\t\t\t\t{Object.entries(colors).map(([key, color]) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={key}\n\t\t\t\t\t\t\t\tclassName={s.color}\n\t\t\t\t\t\t\t\tstyle={{ background: color as string }}\n\t\t\t\t\t\t\t\tonClick={() => setColor(key)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div className={s.countdown}>\n\t\t\t\t\t{shouldShowProgress && (\n\t\t\t\t\t\t<div className={s.progress} style={{\n\t\t\t\t\t\t\ttransition: `all ${expiration - Date.now()}ms linear`,\n\t\t\t\t\t\t\twidth: isProgressInited ? '100%' : '0%',\n\t\t\t\t\t\t}}></div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Palette/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/Tools.tsx",["291","292","293"],[],"import React, { FC, useState } from 'react';\n\nimport cn from 'classnames';\n\nimport { useDraggable } from '../../hooks/useDraggable';\n\nimport { EMode } from '../Canvas';\n\n// import { getToolsMessages, sendToolsMessage } from '../../lib/api';\n// import ee from '../../lib/ee';\n\nimport { Block } from './components/Block';\n\nimport { ToolsContext } from './context';\n\nimport {\n\tStats,\n\tStream,\n\tPixelStats,\n\tFillSquare,\n\tMaps,\n} from './components';\n\nimport * as s from './Tools.module.scss';\n\ninterface Props {\n\tcanvas: any;\n\tcoord: any;\n\trange: any;\n\tcolor: string;\n\tsetCanvasMode: (value: EMode) => void;\n}\n\nexport const Tools: FC<Props> = ({\n\tcanvas,\n\tcoord,\n\trange,\n\tcolor,\n\tsetCanvasMode,\n\t...props\n}) => {\n\n\tconst { anchorRef, draggableRef } = useDraggable({ x: document.body.offsetWidth - 330, y: 10});\n\n\tconst [opened, setOpened] = useState('');\n\tconst [expand, setExpand] = useState(true);\n\n\tconst onToggle = () => {\n\t\tsetExpand((value) => !value);\n\t};\n\n\treturn (\n\t\t<ToolsContext.Provider value={{\n\t\t\topened,\n\t\t\tsetOpened,\n\t\t}}>\n\t\t\t<div className={s.root} ref={draggableRef}>\n\t\t\t\t<div className={s.draggable} ref={anchorRef}>\n\t\t\t\t\t<button className={cn(s.close, { [s.toggled]: !expand })} onClick={onToggle}>\n\t\t\t\t\t\t<div>&gt;</div>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div className={s.content} {...props}>\n\t\t\t\t\t{expand && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Stats />\n\t\t\t\t\t\t\t<Stream />\n\t\t\t\t\t\t\t<PixelStats coord={coord} />\n\t\t\t\t\t\t\t<Maps canvas={canvas} />\n\t\t\t\t\t\t\t<FillSquare\n\t\t\t\t\t\t\t\tcanvas={canvas}\n\t\t\t\t\t\t\t\trange={range}\n\t\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\t\tsetCanvasMode={setCanvasMode}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Block title=\"Откат области без пикселей конкретного юзера?\">FOO</Block>\n\t\t\t\t\t\t\t<Block title=\"Обновление констант\"\n\t\t\t\t\t\t\t\tonOpen={() => console.log('==== open #1')}\n\t\t\t\t\t\t\t\tonClose={() => console.log('==== close #1')}\n\t\t\t\t\t\t\t>TODO</Block>\n\t\t\t\t\t\t\t<Block title=\"Увеличить размер полотна\"\n\t\t\t\t\t\t\t\tonOpen={() => console.log('==== open #2')}\n\t\t\t\t\t\t\t\tonClose={() => console.log('==== close #2')}\n\t\t\t\t\t\t\t>TODO</Block>\n\t\t\t\t\t\t\t<Block title=\"Выставить окончание пиксельбаттла\">TODO</Block>\n\t\t\t\t\t\t\t<Block title=\"Управление банами\">TODO</Block>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</ToolsContext.Provider>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Block/Block.tsx",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Block/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/FillSquare/FillSquare.tsx",["294","295","296","297","298"],[],"import React, { FC, useState, useEffect } from 'react';\n\nimport { Block } from '../Block';\n\nimport { put } from '../../helpers';\n\nimport { EMode } from '../../../Canvas';\n\ninterface Props {\n\tcanvas: any;\n\trange: any;\n\tcolor: string;\n\tsetCanvasMode: (value: EMode) => void;\n}\n\nexport const FillSquare: FC<Props> = ({\n\tcanvas,\n\trange,\n\tcolor,\n\tsetCanvasMode,\n}) => {\n\tconst [opened, setOpened] = useState(false);\n\n\tconst onOpen = () => {\n\t\tif (canvas) {\n\t\t\tcanvas.width = canvas.width;\n\t\t}\n\t\tsetCanvasMode(EMode.SELECT);\n\t};\n\n\tconst onClose = () => {\n\t\tif (canvas) {\n\t\t\tcanvas.width = canvas.width;\n\t\t}\n\t\tsetCanvasMode(EMode.CLICK);\n\t};\n\n\tconst fillSquare = () => {\n\t\tput('fillSquare', JSON.stringify({\n\t\t\t...range,\n\t\t\tcolor,\n\t\t}), 'TEXT');\n\t};\n\n\tuseEffect(() => {\n\t\tif (opened) {\n\t\t\tcanvas.width = canvas.width;\n\n\t\t\tconst ctx = canvas.getContext('2d');\n\n\t\t\tctx.fillStyle = color;\n\t\t\tctx.fillRect(\n\t\t\t\trange?.from?.x,\n\t\t\t\trange?.from?.y,\n\t\t\t\trange?.to?.x - range?.from?.x,\n\t\t\t\trange?.to?.y - range?.from?.y,\n\t\t\t);\n\t\t}\n\t}, [canvas, range, color, opened]);\n\n\treturn (\n\t\t<Block title=\"Заполнение области цветом\"\n\t\t\tonOpen={onOpen}\n\t\t\tonClose={onClose}\n\t\t\tonToggle={setOpened}\n\t\t>\n\t\t\t<div>[{range?.from?.x || -1}:{range?.from?.y || -1} - {range?.to?.x || -1}:{range?.to?.y || -1}] {color}</div>\n\t\t\t<div>{Math.abs(range?.from?.x - range?.to?.x) * Math.abs(range?.from?.y - range?.to?.y)} pixels</div>\n\t\t\t<div>\n\t\t\t\t<button onClick={fillSquare}>готово</button>\n\t\t\t</div>\n\t\t</Block>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/FillSquare/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Maps/Maps.tsx",["299","300","301"],[],"import React, { FC, useState, useEffect } from 'react';\n\nimport { Block } from '../Block';\n\nimport { APIhost } from '../../helpers';\n\n// import * as s from './Maps.module.scss';\n\nconst sec = 1000;\nconst min = sec * 60;\nconst hour = min * 60;\nconst day = hour * 24;\n\ninterface Props {\n\tcanvas: any;\n}\n\nexport const Maps: FC<Props> = ({\n\tcanvas,\n}) => {\n\tconst [opened, setOpened] = useState(false);\n\tconst [lastPixelsValue, setLastPixelsValue] = useState(100);\n\n\tconst getMap = (name: string) => {\n\t\tconst ctx = canvas.getContext('2d');\n\n\t\tconst image = new Image();\n\t\timage.src = `${APIhost}/qq/${name}`;\n\t\timage.onload = () => {\n\t\t\tctx.drawImage(image, 0, 0);\n\t\t};\n\t};\n\n\tconst getHeatmap = () => {\n\t\tgetMap('heatmap.png');\n\t};\n\n\tconst getByUsersMap = () => {\n\t\tgetMap('usersmap.png');\n\t};\n\n\tconst getNewestMap = () => {\n\t\tgetMap('newestmap.png');\n\t};\n\n\tconst getLastPixels = () => {\n\t\tgetMap(`lastPixels.png?count=${lastPixelsValue}`);\n\t};\n\n\tconst handleSelect = (event: any) => {\n\t\tsetLastPixelsValue(Number(event.target.value));\n\t};\n\n\tuseEffect(() => {\n\t\tif (canvas) {\n\t\t\tcanvas.width = canvas.width;\n\t\t}\n\t}, [canvas, opened]);\n\n\treturn (\n\t\t<Block title=\"Карты\" onToggle={setOpened}>\n\t\t\t<div>\n\t\t\t\t<button onClick={getHeatmap}>heatmap</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button onClick={getByUsersMap}>по юзеру</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button onClick={getNewestMap}>по давности</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button onClick={getLastPixels}>последние</button>\n\t\t\t\t<select onChange={handleSelect}>\n\t\t\t\t\t<option value=\"100\">100</option>\n\t\t\t\t\t<option value=\"300\">300</option>\n\t\t\t\t\t<option value=\"500\">500</option>\n\t\t\t\t\t<option value=\"1000\">1 000</option>\n\t\t\t\t\t<option value=\"2000\">2 000</option>\n\t\t\t\t\t<option value=\"3000\">3 000</option>\n\t\t\t\t\t<option value=\"5000\">5 000</option>\n\t\t\t\t\t<option value=\"10000\">10 000</option>\n\t\t\t\t\t<option value=\"30000\">30 000</option>\n\t\t\t\t\t<option value=\"50000\">50 000</option>\n\t\t\t\t\t<option value=\"100000\">100 000</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button>за последний</button>\n\t\t\t\t<select>\n\t\t\t\t\t<option value={min}>1 минута</option>\n\t\t\t\t\t<option value={5 * min}>5 минут</option>\n\t\t\t\t\t<option value={10 * min}>10 минут</option>\n\t\t\t\t\t<option value={15 * min}>15 минут</option>\n\t\t\t\t\t<option value={30 * min}>30 минут</option>\n\t\t\t\t\t<option value={hour}>час</option>\n\t\t\t\t\t<option value={2 * hour}>2 часа</option>\n\t\t\t\t\t<option value={3 * hour}>3 часа</option>\n\t\t\t\t\t<option value={5 * hour}>5 часов</option>\n\t\t\t\t\t<option value={10 * hour}>10 часов</option>\n\t\t\t\t\t<option value={day}>сутки</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</Block>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Maps/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/PixelStats/PixelStats.tsx",["302","303","304","305","306","307","308","309","310"],[],"import React, { FC, useState, useMemo } from 'react';\n\nimport cn from 'classnames';\n\nimport { Block } from '../Block';\n\nimport {\n\tget,\n\tput,\n\tpatch,\n} from '../../helpers';\n\n// import * as s from './Stats.module.scss';\n\ninterface Props {\n\tcoord: {\n\t\tx: number;\n\t\ty: number;\n\t}\n}\n\nexport const PixelStats: FC<Props> = ({ coord }) => {\n\tconst [stats, setStats] = useState<any>({});\n\n\tconst { x, y } = coord || {};\n\n\t// const onChangeFreeze = (event: any) => {\n\t// \tsetCanvasConf((value: any) => ({ ...value, freezed: event.target.value === 'true' }));\n\t// \tpatch('streamSettings', JSON.stringify({ ...canvasConf, freezed: event.target.value === 'true' }), 'TEXT');\n\t// };\n\n\t// const updateFreezedFrame = () => {\n\t// \tput('updateFreezedFrame', null, 'TEXT');\n\t// };\n\n\tconst onOpen = () => {\n\t\t// get('stats').then(setStats);\n\t};\n\n\treturn (\n\t\t<Block title=\"Чей пиксель\">\n\t\t\tTODO\n\t\t\t<div>\n\t\t\t\t{x}:{y} #fff 00:05 назад\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\tПервый вход: 5дн. 00:05 назад\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\tGuest\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button>Все сессии этого юзера</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\tTOKEN: 0000-000-0000000000\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button>Все IP этой сессии</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button>Все IP этого юзера</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\tIP: 0.0.0.0 (City)\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button>Сессии с этим IP</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button>Заблокировать по сессии</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button>Заблокировать по нику</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button>Заблокировать по IP</button>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<button>Таймаут</button>\n\t\t\t\t<select>\n\t\t\t\t\t<option>полчаса</option>\n\t\t\t\t\t<option>час</option>\n\t\t\t\t\t<option>3 часа</option>\n\t\t\t\t\t<option>сутки</option>\n\t\t\t\t\t<option>неделя</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</Block>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/PixelStats/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Stats/Stats.tsx",["311","312"],[],"import React, { FC, useState, useMemo } from 'react';\n\nimport { Block } from '../Block';\n\nimport { get } from '../../helpers';\n\nimport { formatNumber } from '../../../../helpers';\n\ninterface Props {\n}\n\nexport const Stats: FC<Props> = ({}) => {\n\tconst [stats, setStats] = useState<any>({});\n\n\tconst onOpen = () => {\n\t\tget('stats').then(setStats);\n\t};\n\n\tconst agoLabel = useMemo(() => {\n\t\tconst sec = Math.floor(stats?.lastActivity / 1000);\n\t\tconst min = Math.floor(sec / 60);\n\t\tconst hour = Math.floor(min / 60);\n\t\tconst day = Math.floor(hour / 24);\n\t\tconst time = `${day ? `${day}d. ` : ''}${hour ? `${String(hour % 24).padStart(2, '0')}:` : ''}${String(min % 60).padStart(2, '0')}:${String(sec % 60).padStart(2, '0')}`;\n\n\t\treturn time;\n\t}, [stats?.lastActivity]);\n\n\treturn (\n\t\t<Block title=\"Общее\" onOpen={onOpen}>\n\t\t\t<div>\n\t\t\t\tСессии: {stats?.online?.uniq ?? -1} / {stats?.online?.open ?? -1} / {stats?.online?.all ?? -1}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\tАктивность: {agoLabel} назад\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t{stats.lastUserName} ({stats?.lastUserUUID}) {stats?.coord?.x}:{stats?.coord?.y} {stats?.color};\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\tTotal: {formatNumber(stats.total)}\n\t\t\t</div>\n\t\t\t{/* <div>\n\t\t\t\tUptime: 999 д. 01:02:03\n\t\t\t</div> */}\n\t\t</Block>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Stats/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Stream/Stream.tsx",["313","314","315","316"],[],"import React, { FC, useState, useMemo } from 'react';\n\nimport { Block } from '../Block';\n\nimport {\n\tget,\n\tput,\n\tpatch,\n} from '../../helpers';\n\n// import * as s from './Stream.module.scss';\n\ninterface Props {\n}\n\nexport const Stream: FC<Props> = ({}) => {\n\tconst [canvasConf, setCanvasConf] = useState<any>({});\n\n\tconst onChangeFreeze = (event: any) => {\n\t\tsetCanvasConf((value: any) => ({ ...value, freezed: event.target.value === 'true' }));\n\t\tpatch('streamSettings', JSON.stringify({ ...canvasConf, freezed: event.target.value === 'true' }), 'TEXT');\n\t};\n\n\tconst updateFreezedFrame = () => {\n\t\tput('updateFreezedFrame', null, 'TEXT');\n\t};\n\n\tconst onOpen = () => {\n\t\tget('streamSettings').then(setCanvasConf);\n\t};\n\n\tconst checked = useMemo(() => {\n\t\treturn canvasConf?.freezed || false;\n\t}, [canvasConf]);\n\n\treturn (\n\t\t<Block title=\"Трансляция\" onOpen={onOpen}>\n\t\t\t<div>\n\t\t\t\t<input type=\"radio\" id=\"realTime\" name=\"stream\" checked={!checked} value=\"false\" onChange={onChangeFreeze} />\n\t\t\t\t<label htmlFor=\"realTime\">В реальном времени</label>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<input type=\"radio\" id=\"frame\" name=\"stream\" checked={checked} value=\"true\" onChange={onChangeFreeze} />\n\t\t\t\t<label htmlFor=\"frame\">Один кадр</label>\n\t\t\t</div>\n\t\t\t{canvasConf?.freezed && (\n\t\t\t\t<div>\n\t\t\t\t\t<button onClick={updateFreezedFrame}>Обновить кадр</button>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</Block>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/Stream/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/components/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/context.ts",["317","318"],[],"import { createContext, useState } from 'react';\n\nexport const ToolsContext = createContext<{\n\tsetOpened?: Function;\n\topened?: string;\n}>({});\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/helpers.ts",["319","320","321","322"],[],"const { hostname, protocol } = document.location;\nexport const APIhost = `${protocol}//${hostname === 'localhost' ? '' : 'api.'}${hostname.replace('www.', '')}:8080`;\n\nexport const get = async (command: string, type = 'JSON') => {\n\tconst resp = await fetch(`${APIhost}/qq/${command}`, {\n\t\tcredentials: 'include',\n\t});\n\n\tif (type === 'JSON') {\n\t\treturn await resp.json();\n\t}\n\t\n\treturn await resp.text();\n};\n\nexport const push = async (command: string, payload?: any, method = 'POST', type = 'JSON') => {\n\tconst resp = await fetch(`${APIhost}/qq/${command}`, {\n\t\tmethod,\n\t\tcredentials: 'include',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json'\n\t\t},\n\t\tbody: payload,\n\t});\n\n\tif (type === 'JSON') {\n\t\treturn await resp.json();\n\t}\n\n\treturn await resp.text();\n};\n\nexport const post = (command: string, payload?: any, type = 'JSON') => {\n\treturn push(command, payload, 'POST', type);\n};\n\nexport const put = (command: string, payload?: any, type = 'JSON') => {\n\treturn push(command, payload, 'PUT', type);\n};\n\nexport const patch = (command: string, payload?: any, type = 'JSON') => {\n\treturn push(command, payload, 'PATCH', type);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/components/Tools/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/components/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/containers/Admin/App.tsx",["323","324","325","326"],[],"import React, { useRef, useState, useEffect } from 'react';\n\nimport mobile from 'is-mobile';\n\nimport { Canvas, EMode, Palette, Tools } from '../../components';\n\nimport ee from '../../lib/ee';\n\nimport * as s from './App.module.scss';\n\nconst disableMouse = {\n\tonMouseDown: (e: MouseEvent) => e.stopPropagation(),\n\tonMouseMove: (e: MouseEvent) => e.stopPropagation(),\n\tonMouseUp: (e: MouseEvent) => e.stopPropagation(),\n};\n\nexport const App: React.FC = () => {\n\tconst [wsStore, setWsStore] = useState<any>({});\n\tconst [color, setColor] = useState('');\n\tconst [canvasMode, setCanvasMode] = useState(EMode.CLICK);\n\tconst [coord, setCoord] = useState({});\n\tconst [range, setRange] = useState({});\n\tconst [size, setSize] = useState({ width: 0, height: 0 });\n\n\tconst isMobile = mobile();\n\n\tconst layer = useRef(null);\n\n\tuseEffect(() => {\n\t\tif (!color && wsStore?.palette) {\n\t\t\tconst firstColor = 'black' in wsStore?.palette\n\t\t\t\t? 'black'\n\t\t\t\t: (Object.keys(wsStore?.palette) || []).pop();\n\t\t\tsetColor(firstColor as string);\n\t\t}\n\t}, [color, wsStore]);\n\n\tconst handleCanvasClick = (x: number, y: number) => {\n\t\tsetCoord({ x, y });\n\t};\n\n\tconst handleSelect = (from: { x: number; y: number }, to: { x: number; y: number }) => {\n\t\tsetRange({ from, to });\n\t};\n\n\tconst onInitCanvas = (canvas: any) => {\n\t\tsetSize({\n\t\t\twidth: canvas.width,\n\t\t\theight: canvas.height,\n\t\t});\n\t};\n\n\tuseEffect(() => {\n\t\tee.on('ws:init', (payload: any) => {\n\t\t\tsetWsStore((store = {}) => ({ ...store, ...payload }));\n\t\t});\n\t}, []);\n\n\treturn (\n\t\t<div className={isMobile ? 'mobile' : ''}>\n\t\t\t<Canvas\n\t\t\t\tmode={canvasMode}\n\t\t\t\tclassName={s.canvas}\n\t\t\t\tcolor={wsStore?.palette?.[color]}\n\t\t\t\tonClick={handleCanvasClick}\n\t\t\t\tonSelect={handleSelect}\n\t\t\t\tonInit={onInitCanvas}\n\t\t\t>\n\t\t\t\t<canvas className={s.layer} width={size.width} height={size.height} ref={layer}></canvas>\n\t\t\t</Canvas>\n\t\t\t{wsStore?.palette && (\n\t\t\t\t<Palette color={color} colors={wsStore?.palette} setColor={setColor} />\n\t\t\t)}\n\t\t\t<Tools\n\t\t\t\tcanvas={layer.current}\n\t\t\t\tcoord={coord}\n\t\t\t\trange={range}\n\t\t\t\tcolor={color}\n\t\t\t\tsetCanvasMode={setCanvasMode}\n\t\t\t\t{...disableMouse}\n\t\t\t/>\n\t\t</div>\n\t);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/containers/Admin/index.tsx",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/declaration.d.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/color.ts",["327"],[],"export const hexToRgb = (hex: string) => [\n\tparseInt(hex.substring(1, 3), 16),\n\tparseInt(hex.substring(3, 5), 16),\n\tparseInt(hex.substring(5, 7), 16),\n];\n\nexport const rgbToHex = ([r, g, b]: number[]): string => '#' +\n\tr.toString(16).padStart(2, '0') +\n\tg.toString(16).padStart(2, '0') +\n\tb.toString(16).padStart(2, '0');\n\nexport const invertRgb = ([r, g, b]: number[]): number[] => [\n\t255 - r,\n\t255 - g,\n\t255 - b,\n];\n\nexport const getPixelColor = (canvas: any, x: number, y: number) => {\n\tif (!canvas) {\n\t\treturn '#fff';\n\t}\n\n\tconst ctx = canvas.getContext('2d');\n\n\treturn rgbToHex(ctx.getImageData(x, y, 1, 1).data);\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/formatDate.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/formatNumber.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/getInRange.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/index.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/helpers/posIsAbove.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/hooks/useDraggable.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/index.tsx",["328"],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/lib/api.ts",["329","330","331","332","333"],[],"import ee from '../lib/ee';\n\nconst { hostname, protocol } = document.location;\nconst APIhost = `${protocol}//${hostname === 'localhost' ? '' : 'api.'}${hostname.replace('www.', '')}:8080`;\n\nexport const addPix = async ({ x, y, color }) => {\n\ttry {\n\t\tconst resp = await fetch(`${APIhost}/pix`, {\n\t\t\tmethod: 'PUT',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t},\n\t\t\tbody: JSON.stringify({ x, y, color }),\n\t\t});\n\n\t\tconst text = await resp.text();\n\n\t\tee.emit('pix', text);\n\t} catch (e) {}\n};\n\nexport const start = async () => {\n\t\tconst resp = await fetch(`${APIhost}/start`, {\n\t\t\tcredentials: 'include',\n\t\t});\n\n\t\treturn await resp.text();\n};\n\nexport const sendChatMessage = (message: string) => {\n\treturn fetch(`${APIhost}/chat`, {\n\t\tmethod: 'PUT',\n\t\tcredentials: 'include',\n\t\tbody: message,\n\t});\n};\n\nexport const getChatMessages = async () => {\n\tconst resp = await fetch(`${APIhost}/messages`, {\n\t\tcredentials: 'include',\n\t});\n\n\treturn await resp.json();\n};\n\nexport const getStats = async () => {\n\tconst resp = await fetch(`${APIhost}/stats`, {\n\t\tcredentials: 'include',\n\t});\n\n\treturn await resp.json();\n};\n\nexport const getPixel = async (x: number, y: number) => {\n\tconst search = new URLSearchParams({ x, y }).toString();\n\tconst resp = await fetch(`${APIhost}/pix?${search}`, {\n\t\tcredentials: 'include',\n\t});\n\n\treturn await resp.json();\n};\n","/Users/r.bauer/Fun/node-rtmp-stream/src/lib/ee.ts",[],[],"/Users/r.bauer/Fun/node-rtmp-stream/src/lib/ws.ts",["334","335","336"],[],"import ee from './ee';\n\nlet ws: any = null;\n\nconst reduceMessage = ({ data }: any) => {\n\tif (data === '3') {\n\t\treturn;\n\t}\n\n\tlet json = null;\n\ttry {\n\t\tjson = JSON.parse(\n\t\t\tdata.toString()\n\t\t);\n\t} catch (e) {}\n\n\tconst { event, payload } = json;\n\n\tif (event && payload) {\n\t\tee.emit(`ws:${event}`, payload);\n\t}\n};\n\nconst ping = () => {\n\tif (ws) {\n\t\tws.send('2');\n\t}\n};\n\nlet timer = -1;\n\nconst { hostname, protocol, hash } = document.location;\nexport const WSHost = `${hostname === 'localhost' ? '' : 'api.'}${hostname.replace('www.', '')}:8080`;\nconst WSProtocol = (protocol === 'https:' || hash === '#secured') ? 'wss' : 'ws';\n\nexport const connect = () => {\n\tws = new WebSocket(`${WSProtocol}://${WSHost}`);\n\n\tws.onerror = console.error;\n\n\tws.onopen = () => {\n\t\tclearInterval(timer);\n\t\ttimer = setInterval(ping, 10_000);\n\n\t\tee.emit('ws:connect', true);\n\t};\n\n\tws.onmessage = reduceMessage;\n\n\tws.onclose = () => {\n\t\tclearInterval(timer);\n\t\tsetTimeout(connect, 10_000);\n\n\t\tee.emit('ws:connect', false);\n\t};\n};\n",{"ruleId":"337","severity":2,"message":"338","line":39,"column":41,"nodeType":"339","messageId":"340","endLine":39,"endColumn":44,"suggestions":"341"},{"ruleId":"342","severity":2,"message":"343","line":65,"column":34,"nodeType":"344","messageId":"345","endLine":65,"endColumn":50},{"ruleId":"337","severity":2,"message":"338","line":104,"column":29,"nodeType":"339","messageId":"340","endLine":104,"endColumn":32,"suggestions":"346"},{"ruleId":"337","severity":2,"message":"338","line":132,"column":38,"nodeType":"339","messageId":"340","endLine":132,"endColumn":41,"suggestions":"347"},{"ruleId":"348","severity":2,"message":"349","line":37,"column":1,"nodeType":"350","messageId":"351","endLine":37,"endColumn":6,"fix":"352"},{"ruleId":"337","severity":2,"message":"338","line":40,"column":19,"nodeType":"339","messageId":"340","endLine":40,"endColumn":22,"suggestions":"353"},{"ruleId":"337","severity":2,"message":"338","line":164,"column":68,"nodeType":"339","messageId":"340","endLine":164,"endColumn":71,"suggestions":"354"},{"ruleId":"337","severity":2,"message":"338","line":194,"column":60,"nodeType":"339","messageId":"340","endLine":194,"endColumn":63,"suggestions":"355"},{"ruleId":"356","severity":2,"message":"357","line":264,"column":47,"nodeType":"358","messageId":"359","endLine":264,"endColumn":53},{"ruleId":"337","severity":2,"message":"338","line":264,"column":66,"nodeType":"339","messageId":"340","endLine":264,"endColumn":69,"suggestions":"360"},{"ruleId":"337","severity":2,"message":"338","line":316,"column":57,"nodeType":"339","messageId":"340","endLine":316,"endColumn":60,"suggestions":"361"},{"ruleId":"362","severity":2,"message":"363","line":15,"column":11,"nodeType":"358","messageId":"364","endLine":15,"endColumn":19},{"ruleId":"365","severity":2,"message":"366","line":26,"column":2,"nodeType":"367","messageId":"368","endLine":26,"endColumn":3,"fix":"369"},{"ruleId":"370","severity":2,"message":"371","line":38,"column":52,"nodeType":"372","messageId":"373","endLine":38,"endColumn":56,"fix":"374"},{"ruleId":"375","severity":2,"message":"376","line":39,"column":19,"nodeType":"372","messageId":"377","endLine":39,"endColumn":20,"suggestions":"378"},{"ruleId":"375","severity":2,"message":"379","line":39,"column":52,"nodeType":"372","messageId":"377","endLine":39,"endColumn":53,"suggestions":"380"},{"ruleId":"375","severity":2,"message":"376","line":40,"column":19,"nodeType":"372","messageId":"377","endLine":40,"endColumn":20,"suggestions":"381"},{"ruleId":"375","severity":2,"message":"382","line":40,"column":47,"nodeType":"372","messageId":"377","endLine":40,"endColumn":48,"suggestions":"383"},{"ruleId":"384","severity":2,"message":"385","line":40,"column":95,"nodeType":"386","messageId":"387","endLine":41,"endColumn":1,"fix":"388"},{"ruleId":"384","severity":2,"message":"385","line":98,"column":4,"nodeType":"386","messageId":"387","endLine":99,"endColumn":1,"fix":"389"},{"ruleId":"337","severity":2,"message":"338","line":101,"column":27,"nodeType":"339","messageId":"340","endLine":101,"endColumn":30,"suggestions":"390"},{"ruleId":"337","severity":2,"message":"338","line":112,"column":26,"nodeType":"339","messageId":"340","endLine":112,"endColumn":29,"suggestions":"391"},{"ruleId":"384","severity":2,"message":"385","line":159,"column":2,"nodeType":"392","messageId":"387","endLine":160,"endColumn":1,"fix":"393"},{"ruleId":"362","severity":2,"message":"363","line":12,"column":11,"nodeType":"358","messageId":"364","endLine":12,"endColumn":19},{"ruleId":"356","severity":2,"message":"394","line":15,"column":11,"nodeType":"358","messageId":"359","endLine":15,"endColumn":19},{"ruleId":"337","severity":2,"message":"338","line":11,"column":10,"nodeType":"339","messageId":"340","endLine":11,"endColumn":13,"suggestions":"395"},{"ruleId":"337","severity":2,"message":"338","line":27,"column":10,"nodeType":"339","messageId":"340","endLine":27,"endColumn":13,"suggestions":"396"},{"ruleId":"337","severity":2,"message":"338","line":28,"column":9,"nodeType":"339","messageId":"340","endLine":28,"endColumn":12,"suggestions":"397"},{"ruleId":"337","severity":2,"message":"338","line":29,"column":9,"nodeType":"339","messageId":"340","endLine":29,"endColumn":12,"suggestions":"398"},{"ruleId":"337","severity":2,"message":"338","line":10,"column":10,"nodeType":"339","messageId":"340","endLine":10,"endColumn":13,"suggestions":"399"},{"ruleId":"337","severity":2,"message":"338","line":11,"column":9,"nodeType":"339","messageId":"340","endLine":11,"endColumn":12,"suggestions":"400"},{"ruleId":"401","severity":2,"message":"402","line":26,"column":19,"nodeType":"403","messageId":"404","endLine":26,"endColumn":31},{"ruleId":"401","severity":2,"message":"402","line":33,"column":19,"nodeType":"403","messageId":"404","endLine":33,"endColumn":31},{"ruleId":"401","severity":2,"message":"402","line":47,"column":19,"nodeType":"403","messageId":"404","endLine":47,"endColumn":31},{"ruleId":"337","severity":2,"message":"338","line":15,"column":10,"nodeType":"339","messageId":"340","endLine":15,"endColumn":13,"suggestions":"405"},{"ruleId":"337","severity":2,"message":"338","line":50,"column":31,"nodeType":"339","messageId":"340","endLine":50,"endColumn":34,"suggestions":"406"},{"ruleId":"401","severity":2,"message":"402","line":56,"column":19,"nodeType":"403","messageId":"404","endLine":56,"endColumn":31},{"ruleId":"356","severity":2,"message":"407","line":1,"column":31,"nodeType":"358","messageId":"359","endLine":1,"endColumn":38},{"ruleId":"356","severity":2,"message":"408","line":3,"column":8,"nodeType":"358","messageId":"359","endLine":3,"endColumn":10},{"ruleId":"356","severity":2,"message":"409","line":8,"column":2,"nodeType":"358","messageId":"359","endLine":8,"endColumn":5},{"ruleId":"356","severity":2,"message":"410","line":9,"column":2,"nodeType":"358","messageId":"359","endLine":9,"endColumn":5},{"ruleId":"356","severity":2,"message":"411","line":10,"column":2,"nodeType":"358","messageId":"359","endLine":10,"endColumn":7},{"ruleId":"356","severity":2,"message":"412","line":23,"column":9,"nodeType":"358","messageId":"359","endLine":23,"endColumn":14},{"ruleId":"356","severity":2,"message":"413","line":23,"column":16,"nodeType":"358","messageId":"359","endLine":23,"endColumn":24},{"ruleId":"337","severity":2,"message":"338","line":23,"column":37,"nodeType":"339","messageId":"340","endLine":23,"endColumn":40,"suggestions":"414"},{"ruleId":"356","severity":2,"message":"415","line":36,"column":8,"nodeType":"358","messageId":"359","endLine":36,"endColumn":14},{"ruleId":"416","severity":2,"message":"417","line":12,"column":34,"nodeType":"418","messageId":"368","endLine":12,"endColumn":36},{"ruleId":"337","severity":2,"message":"338","line":13,"column":37,"nodeType":"339","messageId":"340","endLine":13,"endColumn":40,"suggestions":"419"},{"ruleId":"416","severity":2,"message":"417","line":16,"column":35,"nodeType":"418","messageId":"368","endLine":16,"endColumn":37},{"ruleId":"337","severity":2,"message":"338","line":17,"column":47,"nodeType":"339","messageId":"340","endLine":17,"endColumn":50,"suggestions":"420"},{"ruleId":"337","severity":2,"message":"338","line":19,"column":33,"nodeType":"339","messageId":"340","endLine":19,"endColumn":36,"suggestions":"421"},{"ruleId":"337","severity":2,"message":"338","line":20,"column":25,"nodeType":"339","messageId":"340","endLine":20,"endColumn":28,"suggestions":"422"},{"ruleId":"356","severity":2,"message":"423","line":1,"column":25,"nodeType":"358","messageId":"359","endLine":1,"endColumn":33},{"ruleId":"362","severity":2,"message":"363","line":4,"column":14,"nodeType":"358","messageId":"364","endLine":4,"endColumn":22},{"ruleId":"337","severity":2,"message":"338","line":16,"column":55,"nodeType":"339","messageId":"340","endLine":16,"endColumn":58,"suggestions":"424"},{"ruleId":"337","severity":2,"message":"338","line":33,"column":49,"nodeType":"339","messageId":"340","endLine":33,"endColumn":52,"suggestions":"425"},{"ruleId":"337","severity":2,"message":"338","line":37,"column":48,"nodeType":"339","messageId":"340","endLine":37,"endColumn":51,"suggestions":"426"},{"ruleId":"337","severity":2,"message":"338","line":41,"column":50,"nodeType":"339","messageId":"340","endLine":41,"endColumn":53,"suggestions":"427"},{"ruleId":"337","severity":2,"message":"338","line":18,"column":41,"nodeType":"339","messageId":"340","endLine":18,"endColumn":44,"suggestions":"428"},{"ruleId":"342","severity":2,"message":"343","line":31,"column":34,"nodeType":"344","messageId":"345","endLine":31,"endColumn":50},{"ruleId":"337","severity":2,"message":"338","line":46,"column":32,"nodeType":"339","messageId":"340","endLine":46,"endColumn":35,"suggestions":"429"},{"ruleId":"337","severity":2,"message":"338","line":54,"column":30,"nodeType":"339","messageId":"340","endLine":54,"endColumn":33,"suggestions":"430"},{"ruleId":"337","severity":2,"message":"338","line":18,"column":39,"nodeType":"339","messageId":"340","endLine":18,"endColumn":42,"suggestions":"431"},{"ruleId":"370","severity":2,"message":"371","line":3,"column":21,"nodeType":"372","messageId":"373","endLine":3,"endColumn":28,"fix":"432"},{"ruleId":"433","severity":2,"message":"434","line":20,"column":14,"nodeType":"435","messageId":"368","endLine":20,"endColumn":16,"suggestions":"436"},{"ruleId":"348","severity":2,"message":"437","line":24,"column":1,"nodeType":"438","messageId":"351","endLine":24,"endColumn":3,"fix":"439"},{"ruleId":"348","severity":2,"message":"440","line":25,"column":1,"nodeType":"358","messageId":"351","endLine":25,"endColumn":4,"fix":"441"},{"ruleId":"348","severity":2,"message":"437","line":26,"column":1,"nodeType":"350","messageId":"351","endLine":26,"endColumn":3,"fix":"442"},{"ruleId":"348","severity":2,"message":"437","line":28,"column":1,"nodeType":"438","messageId":"351","endLine":28,"endColumn":3,"fix":"443"},{"ruleId":"337","severity":2,"message":"338","line":3,"column":9,"nodeType":"339","messageId":"340","endLine":3,"endColumn":12,"suggestions":"444"},{"ruleId":"337","severity":2,"message":"338","line":5,"column":34,"nodeType":"339","messageId":"340","endLine":5,"endColumn":37,"suggestions":"445"},{"ruleId":"433","severity":2,"message":"434","line":15,"column":14,"nodeType":"435","messageId":"368","endLine":15,"endColumn":16,"suggestions":"446"},"@typescript-eslint/no-explicit-any","Unexpected any. Specify a different type.","TSAnyKeyword","unexpectedAny",["447","448"],"no-unsafe-optional-chaining","Unsafe usage of optional chaining. If it short-circuits with 'undefined' the evaluation will throw TypeError.","ChainExpression","unsafeOptionalChain",["449","450"],["451","452"],"indent","Expected indentation of 4 tabs but found 5.","Punctuator","wrongIndentation",{"range":"453","text":"454"},["455","456"],["457","458"],["459","460"],"@typescript-eslint/no-unused-vars","'target' is defined but never used.","Identifier","unusedVar",["461","462"],["463","464"],"@typescript-eslint/ban-types","Don't use `Function` as a type. The `Function` type accepts any function-like value.\nIt provides no type safety when calling the function, which can be a common source of bugs.\nIt also accepts things like class declarations, which will throw at runtime as they will not be called with `new`.\nIf you are expecting the function to accept certain arguments, you should explicitly define the function shape.","bannedTypeMessage","no-extra-semi","Unnecessary semicolon.","EmptyStatement","unexpected",{"range":"465","text":"466"},"quotes","Strings must use singlequote.","Literal","wrongQuotes",{"range":"467","text":"468"},"no-useless-escape","Unnecessary escape character: \\:.","unnecessaryEscape",["469","470"],"Unnecessary escape character: \\=.",["471","472"],["473","474"],"Unnecessary escape character: \\-.",["475","476"],"semi","Missing semicolon.","ReturnStatement","missingSemi",{"range":"477","text":"478"},{"range":"479","text":"478"},["480","481"],["482","483"],"VariableDeclaration",{"range":"484","text":"478"},"'IMessage' is defined but never used.",["485","486"],["487","488"],["489","490"],["491","492"],["493","494"],["495","496"],"no-self-assign","'canvas.width' is assigned to itself.","MemberExpression","selfAssignment",["497","498"],["499","500"],"'useMemo' is defined but never used.","'cn' is defined but never used.","'get' is defined but never used.","'put' is defined but never used.","'patch' is defined but never used.","'stats' is assigned a value but never used.","'setStats' is assigned a value but never used.",["501","502"],"'onOpen' is assigned a value but never used.","no-empty-pattern","Unexpected empty object pattern.","ObjectPattern",["503","504"],["505","506"],["507","508"],["509","510"],"'useState' is defined but never used.",["511","512"],["513","514"],["515","516"],["517","518"],["519","520"],["521","522"],["523","524"],["525","526"],{"range":"527","text":"528"},"no-empty","Empty block statement.","BlockStatement",["529"],"Expected indentation of 1 tab but found 2.","Keyword",{"range":"530","text":"531"},"Expected indentation of 2 tabs but found 3.",{"range":"532","text":"533"},{"range":"534","text":"531"},{"range":"535","text":"531"},["536","537"],["538","539"],["540"],{"messageId":"541","fix":"542","desc":"543"},{"messageId":"544","fix":"545","desc":"546"},{"messageId":"541","fix":"547","desc":"543"},{"messageId":"544","fix":"548","desc":"546"},{"messageId":"541","fix":"549","desc":"543"},{"messageId":"544","fix":"550","desc":"546"},[855,860],"\t\t\t\t",{"messageId":"541","fix":"551","desc":"543"},{"messageId":"544","fix":"552","desc":"546"},{"messageId":"541","fix":"553","desc":"543"},{"messageId":"544","fix":"554","desc":"546"},{"messageId":"541","fix":"555","desc":"543"},{"messageId":"544","fix":"556","desc":"546"},{"messageId":"541","fix":"557","desc":"543"},{"messageId":"544","fix":"558","desc":"546"},{"messageId":"541","fix":"559","desc":"543"},{"messageId":"544","fix":"560","desc":"546"},[553,566],"}\n\ninterface",[784,788],"'ig'",{"messageId":"561","fix":"562","desc":"563"},{"messageId":"564","fix":"565","desc":"566"},{"messageId":"561","fix":"567","desc":"563"},{"messageId":"564","fix":"568","desc":"566"},{"messageId":"561","fix":"569","desc":"563"},{"messageId":"564","fix":"570","desc":"566"},{"messageId":"561","fix":"571","desc":"563"},{"messageId":"564","fix":"572","desc":"566"},[1016,1016],";",[2395,2395],{"messageId":"541","fix":"573","desc":"543"},{"messageId":"544","fix":"574","desc":"546"},{"messageId":"541","fix":"575","desc":"543"},{"messageId":"544","fix":"576","desc":"546"},[3872,3872],{"messageId":"541","fix":"577","desc":"543"},{"messageId":"544","fix":"578","desc":"546"},{"messageId":"541","fix":"579","desc":"543"},{"messageId":"544","fix":"580","desc":"546"},{"messageId":"541","fix":"581","desc":"543"},{"messageId":"544","fix":"582","desc":"546"},{"messageId":"541","fix":"583","desc":"543"},{"messageId":"544","fix":"584","desc":"546"},{"messageId":"541","fix":"585","desc":"543"},{"messageId":"544","fix":"586","desc":"546"},{"messageId":"541","fix":"587","desc":"543"},{"messageId":"544","fix":"588","desc":"546"},{"messageId":"541","fix":"589","desc":"543"},{"messageId":"544","fix":"590","desc":"546"},{"messageId":"541","fix":"591","desc":"543"},{"messageId":"544","fix":"592","desc":"546"},{"messageId":"541","fix":"593","desc":"543"},{"messageId":"544","fix":"594","desc":"546"},{"messageId":"541","fix":"595","desc":"543"},{"messageId":"544","fix":"596","desc":"546"},{"messageId":"541","fix":"597","desc":"543"},{"messageId":"544","fix":"598","desc":"546"},{"messageId":"541","fix":"599","desc":"543"},{"messageId":"544","fix":"600","desc":"546"},{"messageId":"541","fix":"601","desc":"543"},{"messageId":"544","fix":"602","desc":"546"},{"messageId":"541","fix":"603","desc":"543"},{"messageId":"544","fix":"604","desc":"546"},{"messageId":"541","fix":"605","desc":"543"},{"messageId":"544","fix":"606","desc":"546"},{"messageId":"541","fix":"607","desc":"543"},{"messageId":"544","fix":"608","desc":"546"},{"messageId":"541","fix":"609","desc":"543"},{"messageId":"544","fix":"610","desc":"546"},{"messageId":"541","fix":"611","desc":"543"},{"messageId":"544","fix":"612","desc":"546"},{"messageId":"541","fix":"613","desc":"543"},{"messageId":"544","fix":"614","desc":"546"},{"messageId":"541","fix":"615","desc":"543"},{"messageId":"544","fix":"616","desc":"546"},{"messageId":"541","fix":"617","desc":"543"},{"messageId":"544","fix":"618","desc":"546"},[94,101],"'./App'",{"messageId":"619","data":"620","fix":"621","desc":"622"},[562,564],"\t",[611,614],"\t\t",[638,640],[645,647],{"messageId":"541","fix":"623","desc":"543"},{"messageId":"544","fix":"624","desc":"546"},{"messageId":"541","fix":"625","desc":"543"},{"messageId":"544","fix":"626","desc":"546"},{"messageId":"619","data":"627","fix":"628","desc":"622"},"suggestUnknown",{"range":"629","text":"630"},"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct.","suggestNever",{"range":"631","text":"632"},"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of.",{"range":"633","text":"630"},{"range":"634","text":"632"},{"range":"635","text":"630"},{"range":"636","text":"632"},{"range":"637","text":"630"},{"range":"638","text":"632"},{"range":"639","text":"630"},{"range":"640","text":"632"},{"range":"641","text":"630"},{"range":"642","text":"632"},{"range":"643","text":"630"},{"range":"644","text":"632"},{"range":"645","text":"630"},{"range":"646","text":"632"},"removeEscape",{"range":"647","text":"648"},"Remove the `\\`. This maintains the current functionality.","escapeBackslash",{"range":"649","text":"650"},"Replace the `\\` with `\\\\` to include the actual backslash character.",{"range":"651","text":"648"},{"range":"652","text":"650"},{"range":"653","text":"648"},{"range":"654","text":"650"},{"range":"655","text":"648"},{"range":"656","text":"650"},{"range":"657","text":"630"},{"range":"658","text":"632"},{"range":"659","text":"630"},{"range":"660","text":"632"},{"range":"661","text":"630"},{"range":"662","text":"632"},{"range":"663","text":"630"},{"range":"664","text":"632"},{"range":"665","text":"630"},{"range":"666","text":"632"},{"range":"667","text":"630"},{"range":"668","text":"632"},{"range":"669","text":"630"},{"range":"670","text":"632"},{"range":"671","text":"630"},{"range":"672","text":"632"},{"range":"673","text":"630"},{"range":"674","text":"632"},{"range":"675","text":"630"},{"range":"676","text":"632"},{"range":"677","text":"630"},{"range":"678","text":"632"},{"range":"679","text":"630"},{"range":"680","text":"632"},{"range":"681","text":"630"},{"range":"682","text":"632"},{"range":"683","text":"630"},{"range":"684","text":"632"},{"range":"685","text":"630"},{"range":"686","text":"632"},{"range":"687","text":"630"},{"range":"688","text":"632"},{"range":"689","text":"630"},{"range":"690","text":"632"},{"range":"691","text":"630"},{"range":"692","text":"632"},{"range":"693","text":"630"},{"range":"694","text":"632"},{"range":"695","text":"630"},{"range":"696","text":"632"},{"range":"697","text":"630"},{"range":"698","text":"632"},{"range":"699","text":"630"},{"range":"700","text":"632"},{"range":"701","text":"630"},{"range":"702","text":"632"},"suggestComment",{"type":"703"},{"range":"704","text":"705"},"Add comment inside empty block statement.",{"range":"706","text":"630"},{"range":"707","text":"632"},{"range":"708","text":"630"},{"range":"709","text":"632"},{"type":"703"},{"range":"710","text":"705"},[1018,1021],"unknown",[1018,1021],"never",[3009,3012],[3009,3012],[3783,3786],[3783,3786],[868,871],[868,871],[4342,4345],[4342,4345],[5054,5057],[5054,5057],[7157,7160],[7157,7160],[8393,8396],[8393,8396],[829,830],"",[829,829],"\\",[862,863],[862,862],[940,941],[940,940],[968,969],[968,968],[2432,2435],[2432,2435],[2609,2612],[2609,2612],[236,239],[236,239],[517,520],[517,520],[530,533],[530,533],[543,546],[543,546],[199,202],[199,202],[212,215],[212,215],[293,296],[293,296],[972,975],[972,975],[370,373],[370,373],[280,283],[280,283],[301,304],[301,304],[344,347],[344,347],[378,381],[378,381],[461,464],[461,464],[809,812],[809,812],[931,934],[931,934],[1054,1057],[1054,1057],[498,501],[498,501],[1278,1281],[1278,1281],[1409,1412],[1409,1412],[457,460],[457,460],"block",[521,521]," /* empty */ ",[32,35],[32,35],[78,81],[78,81],[207,207]]