function e(e,t,s,a){Object.defineProperty(e,t,{get:s,set:a,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},n={},o=s.parcelRequire8661;null==o&&((o=function(e){if(e in a)return a[e].exports;if(e in n){var t=n[e];delete n[e];var s={id:e,exports:{}};return a[e]=s,t.call(s.exports,s,s.exports),s.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},s.parcelRequire8661=o),o.register("27Lyk",(function(t,s){var a,n;e(t.exports,"register",(()=>a),(e=>a=e)),e(t.exports,"resolve",(()=>n),(e=>n=e));var o={};a=function(e){for(var t=Object.keys(e),s=0;s<t.length;s++)o[t[s]]=e[t[s]]},n=function(e){var t=o[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),o("27Lyk").register(JSON.parse('{"h00hi":"index.bb5dbe0f.js","i6uYg":"twitch.9765d80e.svg","lORw5":"vkplay.1fe42d3c.svg","72mLQ":"youtube.11029b0d.svg","bcdFL":"telegram.59b820bd.svg","757XX":"chat.b83a1653.svg","lcOom":"login.822f9667.svg","9fS6N":"logout.cd3f8ebf.svg","ikpnG":"index.9438551c.css","fDPzC":"index.26dc3d5b.js"}'));var i=o("ayMG0");o("acw62");var r=o("aRPiL"),l=(i=o("ayMG0"),o("acw62")),c=o("8g1PZ"),d=o("fAX6M");o("7Iabx"),o("iWcyK");i=o("ayMG0"),l=o("acw62");var u=o("1D3Re"),h=o("5LNJK"),f=o("im20c");const m=({isAuthorized:e,...t})=>{const[s,a]=(0,l.useState)([]),[n,o]=(0,l.useState)(""),{anchorRef:r,draggableRef:c}=(0,u.useDraggable)({x:document.body.offsetWidth-330,y:60}),d=(0,l.useRef)(null),m=()=>{d.current?.scrollTo(0,d.current.scrollHeight)},p=e=>{a((t=>[...t,e])),setTimeout((()=>{m()}),0)};(0,l.useEffect)((()=>((0,h.getChatMessages)().then((e=>{a(e),setTimeout((()=>{m()}),0),f.default.on("ws:chatMessage",p)})),()=>{f.default.off("ws:chatMessage",p)})),[]);const w=()=>{n&&((0,h.sendChatMessage)(n),o(""))};return(0,i.jsxs)("div",{className:"E3mhTa_root",ref:c,children:[(0,i.jsx)("div",{className:"E3mhTa_draggable",ref:r}),(0,i.jsx)("div",{className:"E3mhTa_content",ref:d,...t,children:s.map((e=>(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[e.name,":"]}),(0,i.jsx)("div",{className:"E3mhTa_text",children:e.text})]},e.id)))}),(0,i.jsxs)("div",{className:"E3mhTa_publisher",...t,children:[(0,i.jsx)("input",{className:"E3mhTa_input",value:n,onChange:e=>{o(e?.target?.value||"")},onKeyUp:e=>{"Enter"===e?.code&&w()},disabled:!e,placeholder:e?"Enter message":"Login for enter message",title:"Press Enter for send message"}),(0,i.jsx)("button",{className:"E3mhTa_button",onClick:w,disabled:!e})]})]})};i=o("ayMG0");o("acw62");i=o("ayMG0");o("acw62");const p=({children:e,onClose:t,width:s="500px",height:a="350px"})=>(0,i.jsx)("div",{className:"i0np6q_root",children:(0,i.jsxs)("div",{className:"i0np6q_window",style:{width:s,height:a},children:[(0,i.jsx)("div",{className:"i0np6q_close",onClick:t,children:"×"}),e]})});o("7SRiy");var w,g=o("iWcyK"),x=o("7SRiy");h=o("5LNJK"),f=o("im20c");w=new URL(o("27Lyk").resolve("i6uYg"),import.meta.url).toString();var v;v=new URL(o("27Lyk").resolve("lORw5"),import.meta.url).toString();var j;j=new URL(o("27Lyk").resolve("72mLQ"),import.meta.url).toString();var _;_=new URL(o("27Lyk").resolve("bcdFL"),import.meta.url).toString();var b;b=new URL(o("27Lyk").resolve("757XX"),import.meta.url).toString();var y;y=new URL(o("27Lyk").resolve("lcOom"),import.meta.url).toString();var N,S,k,R;N=new URL(o("27Lyk").resolve("9fS6N"),import.meta.url).toString(),S="B2wDDG_iconButton",k="B2wDDG_disabled",R="B2wDDG_button";const E={onMouseDown:e=>e.stopPropagation(),onMouseMove:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation()};h=o("5LNJK");var D=o("ksj8G");(0,h.start)().then((e=>{"fail"!==e?(0,D.connect)():document.location.reload()})).catch((()=>{})),(0,r.createRoot)(document.getElementById("root")).render((0,i.jsx)((()=>{const[e,s]=(0,l.useState)(!1),[a,n]=(0,l.useState)({}),[o,r]=(0,l.useState)(""),[u,D]=(0,l.useState)(!1),[L,H]=(0,l.useState)(!1),[C,T]=(0,l.useState)(0),[G,M]=(0,l.useState)(!1),[A,F]=(0,l.useState)(!1),B=(0,l.useRef)(-1),P=t(d)();(0,l.useEffect)((()=>{if(!o&&a?.palette){const e="black"in a?.palette?"black":(Object.keys(a?.palette)||[]).pop();r(e)}}),[o,a]);const O=()=>{const{hostname:e,protocol:t}=document.location,s=`${t}//${"localhost"===e?"":"api."}${e.replace("www.","")}:8080`;document.location.href=`${s}/auth/twitch`},U=e=>{n(((t={})=>({...t,...e}))),T(Date.now()+e?.countdown),H(e?.isAuthorized)},K=e=>{n(((t={})=>({...t,countdown:e}))),T(Date.now()+e)},X=e=>{"await"!==e||L||(F(!0),clearTimeout(B.current),B.current=setTimeout((()=>{F(!1)}),3e3))},$=e=>{M(e)};return(0,l.useEffect)((()=>(f.default.on("ws:init",U),f.default.on("ws:countdown",K),f.default.on("ws:pix",X),f.default.on("ws:connect",$),()=>{f.default.off("ws:init",U),f.default.off("ws:countdown",K),f.default.off("ws:pix",X),f.default.off("ws:connect",$)})),[L]),(0,i.jsxs)("div",{className:P?"mobile":"",children:[(0,i.jsxs)("div",{className:"B2wDDG_header",...E,children:[L?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"B2wDDG_userName",children:a?.name}),(0,i.jsx)("a",{href:"/logout",className:t(c)({[k]:!G}),children:(0,i.jsx)("img",{src:t(N),className:S})})]}):(0,i.jsx)("a",{href:"/login",className:t(c)({[k]:!G,B2wDDG_blinked:A}),children:(0,i.jsx)("img",{src:t(y),className:S})}),(0,i.jsx)("img",{src:t(b),onClick:()=>{D((e=>!e))},className:S})]}),(0,i.jsx)(g.Canvas,{color:a?.palette?.[o],onClick:(e,t)=>{(0,h.addPix)({x:e,y:t,color:o})},expiration:C,isAuthorized:L}),a?.palette&&(0,i.jsx)(x.Palette,{color:o,colors:a?.palette,setColor:r,expiration:C}),e&&(0,i.jsx)(p,{onClose:()=>s(!1),children:(0,i.jsxs)("div",{className:"B2wDDG_joinModalContent",children:[(0,i.jsx)("div",{children:"Чтобы присоединиться к PIXEL BATTLE"}),(0,i.jsx)("div",{children:"напиши свой ник на VK Play"}),(0,i.jsx)("div",{children:(0,i.jsx)("input",{type:"text",className:"B2wDDG_input",placeholder:"nickname"})}),(0,i.jsxs)("div",{children:["и отправь в чат стрима ",(0,i.jsx)("span",{className:"B2wDDG_command",children:"!join"})]}),(0,i.jsx)("button",{onClick:()=>{window.open("https://vkplay.live/pixel_battle/only-chat","",`width=500,height=500,left=${window.innerWidth/2-250},top=${window.innerHeight/2-250}`)},className:R,children:"ОТКРЫТЬ ЧАТ"}),(0,i.jsx)("button",{onClick:O,className:R,children:"Залогинься через Twitch"}),(0,i.jsx)("div",{children:"или"}),(0,i.jsx)("button",{onClick:O,className:R,children:"Залогинься через ВК"})]})}),(0,i.jsxs)("div",{className:"B2wDDG_footer",...E,children:[(0,i.jsx)("a",{href:"https://vkplay.live/place_tv",target:"_blank",children:(0,i.jsx)("img",{src:t(v)})}),(0,i.jsx)("a",{href:"https://www.twitch.tv/place_ru",target:"_blank",children:(0,i.jsx)("img",{src:t(w)})}),(0,i.jsx)("a",{href:"https://www.youtube.com/@Place-ru",target:"_blank",children:(0,i.jsx)("img",{src:t(j)})}),(0,i.jsx)("a",{href:"https://t.me/pixel_battle_online",target:"_blank",children:(0,i.jsx)("img",{src:t(_)})})]}),u&&(0,i.jsx)(m,{isAuthorized:L,...E})]})}),{}));
//# sourceMappingURL=index.bb5dbe0f.js.map
