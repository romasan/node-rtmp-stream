function e(e,t,o,r){Object.defineProperty(e,t,{get:o,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},n={},s=o.parcelRequire8661;null==s&&((s=function(e){if(e in r)return r[e].exports;if(e in n){var t=n[e];delete n[e];var o={id:e,exports:{}};return r[e]=o,t.call(o.exports,o,o.exports),o.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){n[e]=t},o.parcelRequire8661=s),s.register("dRo73",(function(t,o){var r,n;e(t.exports,"register",(()=>r),(e=>r=e)),e(t.exports,"resolve",(()=>n),(e=>n=e));var s={};r=function(e){for(var t=Object.keys(e),o=0;o<t.length;o++)s[t[o]]=e[t[o]]},n=function(e){var t=s[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),s("dRo73").register(JSON.parse('{"aRmpQ":"index.c49b25b5.js","bgmjR":"twitch.9765d80e.svg","1fsQy":"vkplay.1fe42d3c.svg","bWvRY":"youtube.11029b0d.svg","6RFDI":"discord.637209af.svg","9Tcmb":"telegram.59b820bd.svg","aX6ps":"chat.b83a1653.svg","ayPb0":"login.5d897507.svg","cqsRl":"logout.a36fbb3d.svg","24uN4":"info.1855216b.svg","9M2pu":"index.6c0b4e6b.css","irMfh":"index.2d1c0ead.js"}'));var a=s("iM5HV");s("fYo6y");var i,l=s("b2S2j"),c=(a=s("iM5HV"),s("fYo6y")),d=s("PTcTU"),u=s("fvstS"),f=s("g7WMx"),h=s("5Ml5F"),m=s("7Y5nT");i=new URL(s("dRo73").resolve("bgmjR"),import.meta.url).toString();var p;p=new URL(s("dRo73").resolve("1fsQy"),import.meta.url).toString();var w;w=new URL(s("dRo73").resolve("bWvRY"),import.meta.url).toString();var v;v=new URL(s("dRo73").resolve("6RFDI"),import.meta.url).toString();var x;x=new URL(s("dRo73").resolve("9Tcmb"),import.meta.url).toString();var g;g=new URL(s("dRo73").resolve("aX6ps"),import.meta.url).toString();var j;j=new URL(s("dRo73").resolve("ayPb0"),import.meta.url).toString();var _;_=new URL(s("dRo73").resolve("cqsRl"),import.meta.url).toString();var b,R,S,D;b=new URL(s("dRo73").resolve("24uN4"),import.meta.url).toString(),R="B2wDDG_iconButton",S="B2wDDG_disabled",D="B2wDDG_button";const H={onMouseDown:e=>e.stopPropagation(),onMouseMove:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation()};h=s("5Ml5F");var y=s("d165e");(0,h.start)().then((e=>{"fail"!==e?(0,y.connect)():document.location.reload()})).catch((()=>{})),(0,l.createRoot)(document.getElementById("root")).render((0,a.jsx)((()=>{const[e,o]=(0,c.useState)(!1),[r,n]=(0,c.useState)({}),[s,l]=(0,c.useState)(""),[y,N]=(0,c.useState)(!1),[k,E]=(0,c.useState)(!1),[F,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(0),[M,T]=(0,c.useState)(!1),[U,G]=(0,c.useState)(!1),[L,P]=(0,c.useState)(0),[I,O]=(0,c.useState)(!1),[$,Y]=(0,c.useState)(!1),W=(0,c.useRef)(-1),q=()=>{Y(!1),N((e=>!e))},V=()=>{E((e=>!e))},z=t(u)();(0,c.useEffect)((()=>{if(!s&&r?.palette){const e="black"in r?.palette?"black":(Object.keys(r?.palette)||[]).pop();l(e)}}),[s,r]),(0,c.useEffect)((()=>{if(L){const e=setInterval((()=>{L<=Date.now()&&(O(!0),clearInterval(e))}),1e3);return()=>{clearInterval(e)}}}),[L]);const Q=()=>{const{hostname:e,protocol:t}=document.location,o=`${t}//${"localhost"===e?"":"api."}${e.replace("www.","")}:8080`;document.location.href=`${o}/auth/twitch`},X=e=>{n(((t={})=>({...t,...e}))),C(Date.now()+e?.countdown),A(e?.isAuthorized),"newer"!==e.finish&&P(Date.now()+e.finish)},J=e=>{n(((t={})=>({...t,countdown:e}))),C(Date.now()+e)},K=e=>{"await"!==e||F||(G(!0),clearTimeout(W.current),W.current=setTimeout((()=>{G(!1)}),3e3))},Z=e=>{T(e)},ee=e=>{r?.name&&e.text.indexOf(`@${r.name}`)>=0&&Y(!0)};return(0,c.useEffect)((()=>(m.default.on("ws:init",X),m.default.on("ws:countdown",J),m.default.on("pix",K),m.default.on("ws:connect",Z),m.default.on("ws:chatMessage",ee),()=>{m.default.off("ws:init",X),m.default.off("ws:countdown",J),m.default.off("pix",K),m.default.off("ws:connect",Z)})),[F]),(0,a.jsxs)("div",{className:z?"mobile":"",children:[(0,a.jsxs)("div",{className:"B2wDDG_header",...H,children:[F?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"B2wDDG_userName",children:r?.name}),(0,a.jsx)("a",{href:"/logout",className:t(d)({[S]:!M}),children:(0,a.jsx)("img",{src:t(_),className:R})})]}):(0,a.jsx)("a",{href:"/login",className:t(d)({[S]:!M,B2wDDG_blinked:U}),children:(0,a.jsx)("img",{src:t(j),className:R})}),(0,a.jsx)("span",{className:t(d)("B2wDDG_iconWrapper",{B2wDDG_badge:$&&!y}),children:(0,a.jsx)("img",{src:t(g),onClick:q,className:R})}),(0,a.jsx)("img",{src:t(b),onClick:V,className:t(d)(R,{[S]:!M})})]}),(0,a.jsx)(f.Canvas,{color:r?.palette?.[s],onClick:(e,t)=>{(0,h.addPix)({x:e,y:t,color:s})},expiration:B,isAuthorized:F,finished:I}),r?.palette&&!I&&(0,a.jsx)(f.Palette,{color:s,colors:r?.palette,setColor:l,expiration:B}),e&&(0,a.jsx)(f.Modal,{onClose:()=>o(!1),children:(0,a.jsxs)("div",{className:"B2wDDG_joinModalContent",children:[(0,a.jsx)("div",{children:"Чтобы присоединиться к PIXEL BATTLE"}),(0,a.jsx)("div",{children:"напиши свой ник на VK Play"}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"text",className:"B2wDDG_input",placeholder:"nickname"})}),(0,a.jsxs)("div",{children:["и отправь в чат стрима ",(0,a.jsx)("span",{className:"B2wDDG_command",children:"!join"})]}),(0,a.jsx)("button",{onClick:()=>{window.open("https://vkplay.live/pixel_battle/only-chat","",`width=500,height=500,left=${window.innerWidth/2-250},top=${window.innerHeight/2-250}`)},className:D,children:"ОТКРЫТЬ ЧАТ"}),(0,a.jsx)("button",{onClick:Q,className:D,children:"Залогинься через Twitch"}),(0,a.jsx)("div",{children:"или"}),(0,a.jsx)("button",{onClick:Q,className:D,children:"Залогинься через ВК"})]})}),Boolean(L)&&(0,a.jsx)(f.Countdown,{finish:L,text:r.finishText}),(0,a.jsxs)("div",{className:"B2wDDG_footer",...H,children:[(0,a.jsx)("a",{href:"https://vkplay.live/place_tv",target:"_blank",rel:"noreferrer",children:(0,a.jsx)("img",{src:t(p)})}),(0,a.jsx)("a",{href:"https://www.twitch.tv/place_ru",target:"_blank",rel:"noreferrer",children:(0,a.jsx)("img",{src:t(i)})}),(0,a.jsx)("a",{href:"https://www.youtube.com/@Place-ru",target:"_blank",rel:"noreferrer",children:(0,a.jsx)("img",{src:t(w)})}),(0,a.jsx)("a",{href:"https://discord.gg/FfVjurYrus",target:"_blank",rel:"noreferrer",children:(0,a.jsx)("img",{src:t(v)})}),(0,a.jsx)("a",{href:"https://t.me/pixel_battle_online",target:"_blank",rel:"noreferrer",children:(0,a.jsx)("img",{src:t(x)})})]}),y&&(0,a.jsx)(f.Chat,{isAuthorized:F,nickname:r?.name,onClose:q,...H}),k&&(0,a.jsx)(f.Info,{...H,onClose:V})]})}),{}));