var e=globalThis,t={},o={},s=e.parcelRequire8661;null==s&&((s=function(e){if(e in t)return t[e].exports;if(e in o){var s=o[e];delete o[e];var r={id:e,exports:{}};return t[e]=r,s.call(r.exports,r,r.exports),r.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},e.parcelRequire8661=s),s.register;var r=s("iM5HV");s("fYo6y");var a=s("b2S2j"),r=s("iM5HV"),n=s("fYo6y"),i=s("PTcTU"),c=s("g7WMx"),l=s("ifBWf"),u=s("5Ml5F"),d=s("7Y5nT"),f=s("cu5bI"),h=s("gpLKe"),v=s("i63ZM");const p=()=>{let[e,t]=(0,n.useState)(""),[o,s]=(0,n.useState)(""),[a,p]=(0,n.useState)(!1),[x,m]=(0,n.useState)(!1),[M,g]=(0,n.useState)({}),E=(0,n.useRef)(-1),{wsStore:S,isAuthorized:C,expiration:w,isOnline:j,finish:I,hasNewMessage:O,role:b,paused:L,setHasNewMessage:T}=(0,f.useWsStore)(),k=(0,h.useMobileLayout)(),[A,N]=(0,n.useState)("CLICK"),P=v.colorSchemes[S.canvas&&S.canvas.colorScheme]||{};(0,n.useEffect)(()=>{let o="truecolor"===(S&&S.canvas&&S.canvas.colorScheme);if(!e&&P){let e="black"in P&&!o?"black":o?(Object.values(P)||[]).pop():(Object.keys(P)||[]).pop();e&&t(e)}},[e,S]),(0,n.useEffect)(()=>{if(I){let e=setInterval(()=>{I<=Date.now()&&(m(!0),clearInterval(e))},1e3);return()=>{clearInterval(e)}}},[I]);let z=e=>{"await"!==e||C||(p(!0),clearTimeout(E.current),E.current=setTimeout(()=>{p(!1)},3e3))};return(0,n.useEffect)(()=>((0,d.default).on("pix",z),()=>{(0,d.default).off("pix",z)}),[C]),(0,n.useEffect)(()=>(0,l.doOnEnter)("life",()=>{(0,l.life)(M.image)}),[M]),(0,n.useEffect)(()=>{let e=()=>{M&&M.centering()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[M]),(0,n.useEffect)(()=>{S.needAuthorize&&!C&&(0,u.authTgMiniApp)().then(e=>{if("success"===e){document.location.reload();return}}).catch(()=>{})},[C,S]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:(i&&i.__esModule?i.default:i)("O0kWfq_root",{mobile:k}),children:[(0,r.jsx)(c.HeaderLogo,{}),(0,r.jsx)(c.HeaderControls,{isAuthorized:C,name:S?S.name:"",isOnline:j,hasNewMessage:O,setHasNewMessage:T,blinkedLoginAnimation:a,role:b,withTimelapse:!1}),(0,r.jsx)(c.Canvas,{mode:A,color:S.canvas&&"truecolor"===S.canvas.colorScheme?e:P[e],expand:S.canvas,onClick:(t,o)=>{if(A===c.EMode.PICK){s(t),N(c.EMode.CLICK);return}S.needAuthorize&&!C||(0,u.addPix)({x:t,y:o,color:e})},expiration:w,isAuthorized:C,isFinished:x,isOnline:j,onInit:g,src:`${u.APIhost}/canvas.png`}),j&&!x&&(0,r.jsx)(c.Palette,{color:e,pickedColor:o,colorScheme:S.canvas&&S.canvas.colorScheme,setColor:t,onPick:(e=!0)=>{N(e?c.EMode.PICK:c.EMode.CLICK)}}),!!I&&(0,r.jsx)(c.Countdown,{finish:I,text:S.finishText}),L&&(0,r.jsx)("div",{className:"O0kWfq_paused",children:"PAUSE ||"})]})})};var u=s("5Ml5F"),x=s("d165e");(0,u.start)().then(e=>{(0,x.connect)(),(0,a.createRoot)(document.getElementById("root")).render((0,r.jsx)(p,{}))}).catch(()=>{});