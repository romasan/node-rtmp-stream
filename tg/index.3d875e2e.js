var e=globalThis,s={},o={},t=e.parcelRequire8661;null==t&&((t=function(e){if(e in s)return s[e].exports;if(e in o){var t=o[e];delete o[e];var i={id:e,exports:{}};return s[e]=i,t.call(i.exports,i,i.exports),i.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,s){o[e]=s},e.parcelRequire8661=t),(0,t.register)("dvwnk",function(e,s){Object.defineProperty(e.exports,"useApp",{get:()=>d,set:void 0,enumerable:!0,configurable:!0});var o=t("fYo6y"),i=t("cu5bI"),n=t("gpLKe"),a=t("ifBWf"),r=t("7Y5nT"),l=t("i63ZM"),c=t("g7WMx");let d=()=>{let[e,s]=(0,o.useState)(""),[t,d]=(0,o.useState)(""),[u,f]=(0,o.useState)(!1),[h,p]=(0,o.useState)(!1),[v,C]=(0,o.useState)({}),M=(0,o.useRef)(-1),{wsStore:x,isAuthorized:m,expiration:g,isOnline:w,finish:E,hasNewMessage:k,role:b,paused:I,setHasNewMessage:S}=(0,i.useWsStore)(),P=(0,n.useMobileLayout)(),[A,L]=(0,o.useState)("CLICK"),O=l.colorSchemes[x.canvas&&x.canvas.colorScheme]||{};(0,o.useEffect)(()=>{let o="truecolor"===(x&&x.canvas&&x.canvas.colorScheme);if(!e&&O){let e="black"in O&&!o?"black":o?(Object.values(O)||[]).pop():(Object.keys(O)||[]).pop();e&&s(e)}},[e,x]),(0,o.useEffect)(()=>{if(E){let e=setInterval(()=>{E<=Date.now()&&(p(!0),clearInterval(e))},1e3);return()=>{clearInterval(e)}}},[E]);let j=e=>{"await"!==e||m||(f(!0),clearTimeout(M.current),M.current=setTimeout(()=>{f(!1)},3e3))};return(0,o.useEffect)(()=>((0,r.default).on("pix",j),()=>{(0,r.default).off("pix",j)}),[m]),(0,o.useEffect)(()=>(0,a.doOnEnter)("life",()=>{(0,a.life)(v.image)}),[v]),(0,o.useEffect)(()=>{let e=()=>{v&&v.centering()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[v]),{color:e,setColor:s,pickedColor:t,setPickedColor:d,blinkedLoginAnimation:u,isFinished:h,setIsFinished:p,canvas:v,setCanvas:C,wsStore:x,isAuthorized:m,expiration:g,isOnline:w,finish:E,hasNewMessage:k,role:b,paused:I,setHasNewMessage:S,isMobile:P,canvasMode:A,setCanvasMode:L,palette:O,handleCanvasClick:(e,s)=>{if(A===c.EMode.PICK){d(e),L(c.EMode.CLICK);return}},handlePick:e=>{"boolean"==typeof e?(d(""),L(e?c.EMode.PICK:c.EMode.CLICK)):L(e=>e===c.EMode.PICK?c.EMode.CLICK:c.EMode.PICK)},onPix:j}}});var i=t("iM5HV");t("fYo6y");var n=t("b2S2j"),i=t("iM5HV"),a=t("fYo6y"),r=t("PTcTU"),l=t("g7WMx"),c=t("5Ml5F"),d=t("dvwnk");const u=()=>{(0,a.useRef)(-1);let{color:e,setColor:s,pickedColor:o,setPickedColor:t,blinkedLoginAnimation:n,isFinished:u,setCanvas:f,wsStore:h,isAuthorized:p,expiration:v,isOnline:C,finish:M,hasNewMessage:x,role:m,paused:g,setHasNewMessage:w,isMobile:E,canvasMode:k,setCanvasMode:b,palette:I,handlePick:S}=(0,d.useApp)();return(0,a.useEffect)(()=>{h.needAuthorize&&!p&&(0,c.authTgMiniApp)().then(e=>{if("success"===e){document.location.reload();return}}).catch(()=>{})},[p,h]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:(r&&r.__esModule?r.default:r)("O0kWfq_root",{mobile:E}),children:[(0,i.jsx)(l.HeaderLogo,{}),(0,i.jsx)(l.HeaderControls,{isAuthorized:p,name:h?h.name:"",isOnline:C,hasNewMessage:x,setHasNewMessage:w,blinkedLoginAnimation:n,role:m,withTimelapse:!1}),(0,i.jsx)(l.Canvas,{mode:k,color:h.canvas&&"truecolor"===h.canvas.colorScheme?e:I[e],expand:h.canvas,onClick:(s,o)=>{if(k===l.EMode.PICK){t(s),b(l.EMode.CLICK);return}(0,c.addPix)({x:s,y:o,color:e})},expiration:v,isAuthorized:p,isFinished:u,isOnline:C,onInit:f,src:`${c.APIhost}/canvas.png`}),C&&!u&&(0,i.jsx)(l.Palette,{mode:k,color:e,pickedColor:o,colorScheme:h.canvas&&h.canvas.colorScheme,setColor:s,onPick:S}),!!M&&(0,i.jsx)(l.Countdown,{finish:M,text:h.finishText}),g&&(0,i.jsx)("div",{className:"O0kWfq_paused",children:"PAUSE ||"})]})})};var c=t("5Ml5F"),f=t("d165e");(0,c.start)().then(e=>{(0,f.connect)(),(0,n.createRoot)(document.getElementById("root")).render((0,i.jsx)(u,{}))}).catch(()=>{});