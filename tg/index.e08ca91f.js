var e=globalThis,t={},o={},s=e.parcelRequire8661;null==s&&((s=function(e){if(e in t)return t[e].exports;if(e in o){var s=o[e];delete o[e];var r={id:e,exports:{}};return t[e]=r,s.call(r.exports,r,r.exports),r.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},e.parcelRequire8661=s),s.register;var r=s("iM5HV");s("fYo6y");var a=s("b2S2j"),r=s("iM5HV"),n=s("fYo6y"),i=s("PTcTU"),c=s("g7WMx"),l=s("ifBWf"),u=s("5Ml5F"),d=s("7Y5nT"),f=s("cu5bI"),h=s("gpLKe"),v=s("i63ZM");const m=()=>{let[e,t]=(0,n.useState)(""),[o,s]=(0,n.useState)(""),[a,m]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!1),[M,E]=(0,n.useState)({}),g=(0,n.useRef)(-1),{wsStore:C,isAuthorized:S,expiration:w,isOnline:I,finish:j,hasNewMessage:O,role:b,paused:L,setHasNewMessage:T}=(0,f.useWsStore)(),k=(0,h.useMobileLayout)(),[A,P]=(0,n.useState)("CLICK"),N=v.colorSchemes[C.canvas&&C.canvas.colorScheme]||{};(0,n.useEffect)(()=>{let o="truecolor"===(C&&C.canvas&&C.canvas.colorScheme);if(!e&&N){let e="black"in N&&!o?"black":o?(Object.values(N)||[]).pop():(Object.keys(N)||[]).pop();e&&t(e)}},[e,C]),(0,n.useEffect)(()=>{if(j){let e=setInterval(()=>{j<=Date.now()&&(x(!0),clearInterval(e))},1e3);return()=>{clearInterval(e)}}},[j]);let z=e=>{"await"!==e||S||(m(!0),clearTimeout(g.current),g.current=setTimeout(()=>{m(!1)},3e3))};return(0,n.useEffect)(()=>((0,d.default).on("pix",z),()=>{(0,d.default).off("pix",z)}),[S]),(0,n.useEffect)(()=>(0,l.doOnEnter)("life",()=>{(0,l.life)(M.image)}),[M]),(0,n.useEffect)(()=>{let e=()=>{M&&M.centering()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[M]),(0,n.useEffect)(()=>{C.needAuthorize&&!S&&(0,u.authTgMiniApp)().then(e=>{if("success"===e){document.location.reload();return}}).catch(()=>{})},[S,C]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:(i&&i.__esModule?i.default:i)("O0kWfq_root",{mobile:k}),children:[(0,r.jsx)(c.HeaderLogo,{}),(0,r.jsx)(c.HeaderControls,{isAuthorized:S,name:C?C.name:"",isOnline:I,hasNewMessage:O,setHasNewMessage:T,blinkedLoginAnimation:a,role:b,withTimelapse:!1}),(0,r.jsx)(c.Canvas,{mode:A,color:C.canvas&&"truecolor"===C.canvas.colorScheme?e:N[e],expand:C.canvas,onClick:(t,o)=>{if(A===c.EMode.PICK){s(t),P(c.EMode.CLICK);return}C.needAuthorize&&!S||(0,u.addPix)({x:t,y:o,color:e})},expiration:w,isAuthorized:S,isFinished:p,isOnline:I,onInit:E,src:`${u.APIhost}/canvas.png`}),I&&!p&&(0,r.jsx)(c.Palette,{mode:A,color:e,pickedColor:o,colorScheme:C.canvas&&C.canvas.colorScheme,setColor:t,onPick:()=>{P(e=>e===c.EMode.PICK?c.EMode.CLICK:c.EMode.PICK)}}),!!j&&(0,r.jsx)(c.Countdown,{finish:j,text:C.finishText}),L&&(0,r.jsx)("div",{className:"O0kWfq_paused",children:"PAUSE ||"})]})})};var u=s("5Ml5F"),p=s("d165e");(0,u.start)().then(e=>{(0,p.connect)(),(0,a.createRoot)(document.getElementById("root")).render((0,r.jsx)(m,{}))}).catch(()=>{});